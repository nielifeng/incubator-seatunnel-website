<!doctype html>
<html lang="zh-CN" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.16">
<link rel="alternate" type="application/rss+xml" href="/zh-CN/blog/rss.xml" title="Apache SeaTunnel RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/zh-CN/blog/atom.xml" title="Apache SeaTunnel Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/zh-CN/user_cases/rss.xml" title="Apache SeaTunnel RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/zh-CN/user_cases/atom.xml" title="Apache SeaTunnel Atom Feed">
<script src="https://hm.baidu.com/hm.js?33a9aab233e1082f91e4e347ad716701" async></script><title data-rh="true">Blog | Apache SeaTunnel</title><meta data-rh="true" property="og:title" content="Blog | Apache SeaTunnel"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" name="description" content="Blog"><meta data-rh="true" property="og:description" content="Blog"><meta data-rh="true" property="og:url" content="https://seatunnel.apache.org/zh-CN/blog/page/2"><meta data-rh="true" name="docsearch:language" content="zh-CN"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_posts_list"><link data-rh="true" rel="icon" href="/zh-CN/image/favicon.ico"><link data-rh="true" rel="canonical" href="https://seatunnel.apache.org/zh-CN/blog/page/2"><link data-rh="true" rel="alternate" href="https://seatunnel.apache.org/blog/page/2" hreflang="en"><link data-rh="true" rel="alternate" href="https://seatunnel.apache.org/zh-CN/blog/page/2" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://seatunnel.apache.org/blog/page/2" hreflang="x-default"><link rel="stylesheet" href="/zh-CN/assets/css/styles.04990753.css">
<link rel="preload" href="/zh-CN/assets/js/runtime~main.41b866cf.js" as="script">
<link rel="preload" href="/zh-CN/assets/js/main.accb60dc.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><div class="announcementBar_IbjG" style="background-color:rgb(70, 125, 175, 0.8)" role="banner"><div class="announcementBarContent_KsVm">ğŸ¤” Have queries regarding Apache SeaTunnel, Join Slack channel to discuss them join <a target="_blank" rel="noopener noreferrer" href="https://join.slack.com/t/apacheseatunnel/shared_invite/zt-123jmewxe-RjB_DW3M3gV~xL91pZ0oVQ">#SeaTunnel</a> channel! ğŸŒŸ</div></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zh-CN/"><div class="navbar__logo"><img src="/zh-CN/image/logo.png" alt="Apache SeaTunnel Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/zh-CN/image/logo.png" alt="Apache SeaTunnel Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Apache SeaTunnel</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/zh-CN/">é¦–é¡µ</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link">æ–‡æ¡£</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/zh-CN/docs/2.3.0/about">2.3.0</a></li><li><a class="dropdown__link" href="/zh-CN/docs/2.3.0-beta/about">2.3.0-beta</a></li><li><a class="dropdown__link" href="/zh-CN/docs/2.2.0-beta/intro/about">2.2.0-beta</a></li><li><a class="dropdown__link" href="/zh-CN/docs/2.1.3/intro/about">2.1.3</a></li><li><a class="dropdown__link" href="/zh-CN/docs/2.1.2/intro/about">2.1.2</a></li><li><a class="dropdown__link" href="/zh-CN/docs/2.1.1/intro/about">2.1.1</a></li><li><a class="dropdown__link" href="/zh-CN/docs/2.1.0/introduction">2.1.0</a></li><li><a class="dropdown__link" href="/zh-CN/docs/1.x/introduction">1.x(Not Apache Release)</a></li><li><a class="dropdown__link" href="/zh-CN/docs/about">Next</a></li><li><a class="dropdown__link" href="/zh-CN/versions/">All versions</a></li></ul></div><a class="navbar__item navbar__link" href="/zh-CN/download">ä¸‹è½½</a><a class="navbar__item navbar__link" href="/zh-CN/community/contribution_guide/contribute">ç¤¾åŒº</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/zh-CN/blog">åšå®¢</a><a class="navbar__item navbar__link" href="/zh-CN/user_cases">ç”¨æˆ·æ¡ˆä¾‹</a><a class="navbar__item navbar__link" href="/zh-CN/team">å›¢é˜Ÿ</a><a class="navbar__item navbar__link" href="/zh-CN/user">ç”¨æˆ·</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link">Apache</a><ul class="dropdown__menu"><li><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="dropdown__link">åŸºé‡‘ä¼š</a></li><li><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="dropdown__link">è¯ä¹¦</a></li><li><a href="https://www.apache.org/events/current-event" target="_blank" rel="noopener noreferrer" class="dropdown__link">äº‹ä»¶</a></li><li><a href="https://www.apache.org/security/" target="_blank" rel="noopener noreferrer" class="dropdown__link">å®‰å…¨</a></li><li><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">èµåŠ©</a></li><li><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">è‡´è°¢</a></li></ul></div><a href="https://github.com/apache/incubator-seatunnel" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-list-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_a9qW thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_uKok margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Kvuv"><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/zh-CN/blog/Apache IoTDB (Internet of Things Database) is a software system that integrates the collection">SeaTunnel supports IoTDB to implement IoT data synchronization</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/zh-CN/blog/Apache SeaTunnel Committer | Zongwen Li">SeaTunnel engine, designed for tens-of-billions data integration</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/zh-CN/blog/During the joint Apache SeaTunnel &amp; IoTDB Meetup on October 15,">Mafengwo finally chose Apache SeaTunnel after analyzing these 9 points of how it works!</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/zh-CN/blog/2022/09/20/A-tutorial-to-help-you develop-a-SeaTunnel-Connector-hand-by-hand-while-avoiding -pitfalls">A tutorial to help you develop a SeaTunnel Connector hand-by-hand while avoiding pitfalls</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/zh-CN/blog/2022/09/19/Code-Demo-for-SeaTunnel-Connector-Development-Process">Code Demo for SeaTunnel Connector Development Process</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_rzP5" itemprop="headline"><a itemprop="url" href="/zh-CN/blog/2022/05/01/_Kidswant">SeaTunnel åœ¨å­©å­ç‹çš„é€‰å‹è¿‡ç¨‹åŠåº”ç”¨æ”¹é€ å®è·µ</a></h2><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2022-05-01T00:00:00.000Z" itemprop="datePublished">2022å¹´5æœˆ1æ—¥</time> Â· <!-- -->One min read</div></header><div class="markdown" itemprop="articleBody"><p><img loading="lazy" src="/zh-CN/assets/images/0-38f7968af0b7239e9d427a85adee4452.png" width="1920" height="1080"></p><p>åœ¨Apache SeaTunnel(Incubating) 4 æœˆMeetupä¸Šï¼Œå­©å­ç‹å¤§æ•°æ®ä¸“å®¶ã€OLAPå¹³å°æ¶æ„å¸ˆ è¢æ´ªå†› ä¸ºæˆ‘ä»¬å¸¦æ¥äº†ã€ŠApache SeaTunnel (Incubating)åœ¨å­©å­ç‹çš„åº”ç”¨å®è·µã€‹ã€‚</p><p>æœ¬æ¬¡æ¼”è®²ä¸»è¦åŒ…å«äº”ä¸ªéƒ¨åˆ†ï¼š</p><ul><li><p>å­©å­ç‹å¼•å…¥Apache SeaTunnel (Incubating)çš„èƒŒæ™¯ä»‹ç»</p></li><li><p>å¤§æ•°æ®å¤„ç†ä¸»æµå·¥å…·å¯¹æ¯”åˆ†æ</p></li><li><p>Apache SeaTunnel (Incubating)çš„è½åœ°å®è·µ</p></li><li><p>Apache SeaTunnel (Incubating)æ”¹é€ ä¸­çš„å¸¸è§é—®é¢˜</p></li><li><p>å¯¹å­©å­ç‹æœªæ¥å‘å±•æ–¹å‘çš„é¢„æµ‹å±•æœ›</p></li></ul><p><img loading="lazy" src="/zh-CN/assets/images/0-1-4c853aa726b29acc5954ba53240dc2b8.png" width="2578" height="2567"></p><p>è¢æ´ªå†›</p><p>å­©å­ç‹ å¤§æ•°æ®ä¸“å®¶ã€OLAP å¹³å°æ¶æ„å¸ˆã€‚å¤šå¹´å¤§æ•°æ®å¹³å°ç ”å‘ç®¡ç†ç»éªŒï¼Œåœ¨æ•°æ®èµ„äº§ã€è¡€ç¼˜å›¾è°±ã€æ•°æ®æ²»ç†ã€OLAP ç­‰é¢†åŸŸæœ‰ç€ä¸°å¯Œçš„ç ”ç©¶ç»éªŒã€‚</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="01-èƒŒæ™¯ä»‹ç»">01 èƒŒæ™¯ä»‹ç»<a class="hash-link" href="#01-èƒŒæ™¯ä»‹ç»" title="Direct link to heading">â€‹</a></h2><p><img loading="lazy" src="/zh-CN/assets/images/1-b67aae24cc6274ca2d6a4541848b847d.png" width="1583" height="979"></p><p>ç›®å‰å­©å­ç‹çš„OLAPå¹³å°ä¸»è¦åŒ…å«å…ƒæ•°æ®å±‚ã€ä»»åŠ¡å±‚ã€å­˜å‚¨å±‚ã€SQLå±‚ã€è°ƒåº¦å±‚ã€æœåŠ¡å±‚ä»¥åŠç›‘æ§å±‚ä¸ƒéƒ¨åˆ†ï¼Œæœ¬æ¬¡åˆ†äº«ä¸»è¦å…³æ³¨ä»»åŠ¡å±‚ä¸­çš„ç¦»çº¿ä»»åŠ¡ã€‚</p><p>å…¶å®å­©å­ç‹å†…éƒ¨æœ‰ä¸€å¥—å®Œæ•´çš„é‡‡é›†æ¨é€ç³»ç»Ÿï¼Œä½†ç”±äºä¸€äº›å†å²é—ç•™é—®é¢˜ï¼Œå…¬å¸ç°æœ‰çš„å¹³å°æ— æ³•å¿«é€Ÿæ”¯æŒOLAPå¹³å°ä¸Šçº¿ï¼Œå› æ­¤å½“æ—¶å…¬å¸åªèƒ½é€‰æ‹©æ”¾å¼ƒè‡ªèº«çš„å¹³å°ï¼Œè½¬è€Œç€æ‰‹ç ”å‘æ–°çš„ç³»ç»Ÿã€‚</p><p>å½“æ—¶æ‘†åœ¨OLAPé¢å‰çš„æœ‰ä¸‰ä¸ªé€‰æ‹©ï¼š</p><p>1ã€ç»™äºˆé‡‡é›†æ¨é€ç³»ç»ŸåšäºŒæ¬¡ç ”å‘ï¼›</p><p>2ã€å®Œå…¨è‡ªç ”ï¼›</p><p>3ã€å‚ä¸å¼€æºé¡¹ç›®ã€‚</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="02-å¤§æ•°æ®å¤„ç†ä¸»æµå·¥å…·å¯¹æ¯”åˆ†æ">02 å¤§æ•°æ®å¤„ç†ä¸»æµå·¥å…·å¯¹æ¯”åˆ†æ<a class="hash-link" href="#02-å¤§æ•°æ®å¤„ç†ä¸»æµå·¥å…·å¯¹æ¯”åˆ†æ" title="Direct link to heading">â€‹</a></h2><p>è€Œè¿™ä¸‰é¡¹é€‰æ‹©å´å„æœ‰ä¼˜åŠ£ã€‚è‹¥é‡‡åŸºäºé‡‡é›†æ¨é€åšäºŒæ¬¡ç ”å‘ï¼Œå…¶ä¼˜ç‚¹æ˜¯æœ‰å‰äººçš„ç»éªŒï¼Œèƒ½å¤Ÿé¿å…é‡å¤è¸©å‘ã€‚ä½†ç¼ºç‚¹æ˜¯ä»£ç é‡å¤§ï¼Œç ”è¯»æ—¶é—´ã€ç ”è¯»å‘¨æœŸè¾ƒé•¿ï¼Œè€Œä¸”æŠ½è±¡ä»£ç è¾ƒå°‘ï¼Œä¸ä¸šåŠ¡ç»‘å®šçš„å®šåˆ¶åŒ–åŠŸèƒ½è¾ƒå¤šï¼Œè¿™ä¹Ÿå¯¼è‡´äº†å…¶äºŒå¼€çš„éš¾åº¦è¾ƒå¤§ã€‚</p><p>è‹¥å®Œå…¨è‡ªç ”ï¼Œå…¶ä¼˜ç‚¹ç¬¬ä¸€æ˜¯å¼€å‘è¿‡ç¨‹è‡ªä¸»å¯æ§ï¼Œç¬¬äºŒæ˜¯å¯ä»¥é€šè¿‡Sparkç­‰ä¸€äº›å¼•æ“åšè´´åˆæˆ‘ä»¬è‡ªèº«çš„æ¶æ„ï¼Œä½†ç¼ºç‚¹æ˜¯å¯èƒ½ä¼šé­é‡ä¸€äº›æœªçŸ¥çš„é—®é¢˜ã€‚</p><p>æœ€åå¦‚æœä½¿ç”¨å¼€æºæ¡†æ¶ï¼Œå…¶ä¼˜ç‚¹ä¸€æ˜¯æŠ½è±¡ä»£ç è¾ƒå¤šï¼ŒäºŒæ˜¯ç»è¿‡å…¶ä»–å¤§å‚æˆ–å…¬å¸çš„éªŒè¯ï¼Œæ¡†æ¶åœ¨æ€§èƒ½å’Œç¨³å®šæ–¹é¢èƒ½å¤Ÿå¾—åˆ°ä¿éšœã€‚å› æ­¤å­©å­ç‹åœ¨OLAPæ•°æ®åŒæ­¥åˆæœŸï¼Œæˆ‘ä»¬ä¸»è¦ç ”ç©¶äº†DATAXã€Sqoopå’ŒSeaTunnelè¿™ä¸‰ä¸ªå¼€æºæ•°æ®åŒæ­¥å·¥å…·ã€‚</p><p><img loading="lazy" src="/zh-CN/assets/images/2-a6b8a591b0c27aed589b35565edf7c02.png" width="876" height="915"></p><p>ä»è„‘å›¾æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒSqoopçš„ä¸»è¦åŠŸèƒ½æ˜¯é’ˆå¯¹RDBçš„æ•°æ®åŒæ­¥ï¼Œå…¶å®ç°æ–¹å¼æ˜¯åŸºäºMAP/REDUCEã€‚Sqoopæ‹¥æœ‰ä¸°å¯Œçš„å‚æ•°å’Œå‘½ä»¤è¡Œå¯ä»¥å»æ‰§è¡Œå„ç§æ“ä½œã€‚Sqoopçš„ä¼˜ç‚¹åœ¨äºå®ƒé¦–å…ˆè´´åˆHadoopç”Ÿæ€ï¼Œå¹¶å·²ç»æ”¯æŒå¤§éƒ¨åˆ†RDBåˆ°HIVEä»»æ„æºçš„è½¬æ¢ï¼Œæ‹¥æœ‰å®Œæ•´çš„å‘½ä»¤é›†å’ŒAPIçš„åˆ†å¸ƒå¼æ•°æ®åŒæ­¥å·¥å…·ã€‚</p><p>ä½†å…¶ç¼ºç‚¹æ˜¯Sqoopåªæ”¯æŒRDBçš„æ•°æ®åŒæ­¥ï¼Œå¹¶ä¸”å¯¹äºæ•°æ®æ–‡ä»¶æœ‰ä¸€å®šçš„é™åˆ¶ï¼Œä»¥åŠè¿˜æ²¡æœ‰æ•°æ®æ¸…æ´—çš„æ¦‚å¿µã€‚</p><p><img loading="lazy" src="/zh-CN/assets/images/3-3ff7bcde6e57af360cccd3d50e713b8e.png" width="2452" height="1485"></p><p>DataXçš„ä¸»è¦åŠŸèƒ½æ˜¯ä»»æ„æºçš„æ•°æ®åŒæ­¥ï¼Œé€šè¿‡é…ç½®åŒ–æ–‡ä»¶+å¤šçº¿ç¨‹çš„æ–¹å¼å®ç°ï¼Œä¸»è¦åˆ†ä¸ºä¸‰ä¸ªæµç¨‹ï¼šReaderã€Frameworkå’ŒWriterï¼Œå…¶ä¸­Frameworkä¸»è¦èµ·åˆ°é€šä¿¡å’Œç•™ç©ºçš„ä½œç”¨ã€‚</p><p>DataXçš„ä¼˜ç‚¹æ˜¯å®ƒé‡‡ç”¨äº†æ’ä»¶å¼çš„å¼€å‘ï¼Œæ‹¥æœ‰è‡ªå·±çš„æµæ§å’Œæ•°æ®ç®¡æ§ï¼Œåœ¨ç¤¾åŒºæ´»è·ƒåº¦ä¸Šï¼ŒDataXçš„å®˜ç½‘ä¸Šæä¾›äº†è®¸å¤šä¸åŒæºçš„æ•°æ®æ¨é€ã€‚ä½†DataXçš„ç¼ºç‚¹åœ¨äºå®ƒåŸºäºå†…å­˜ï¼Œå¯¹æ•°æ®é‡å¯èƒ½å­˜åœ¨é™åˆ¶ã€‚</p><p><img loading="lazy" src="/zh-CN/assets/images/4-96dfdedcf3c28bf69a805f20cc51e960.png" width="2199" height="1860"></p><p>Apache SeaTunnel (Incubating)åšçš„ä¹Ÿæ˜¯ä»»æ„æºçš„æ•°æ®åŒæ­¥ï¼Œå®ç°æµç¨‹åˆ†ä¸ºsourceã€transformå’Œsinkä¸‰æ­¥ï¼ŒåŸºäºé…ç½®æ–‡ä»¶ã€Sparkæˆ–Flinkå®ç°ã€‚å…¶ä¼˜ç‚¹æ˜¯ç›®å‰å®˜ç½‘2.1.0æœ‰éå¸¸å¤šçš„æ’ä»¶å’Œæºçš„æ¨é€ï¼ŒåŸºäºæ’ä»¶å¼çš„æ€æƒ³ä¹Ÿä½¿å…¶éå¸¸å®¹æ˜“æ‰©å±•ï¼Œæ‹¥æŠ±Sparkå’ŒFlinkçš„åŒæ—¶ä¹Ÿåšåˆ°äº†åˆ†å¸ƒå¼çš„æ¶æ„ã€‚è¦è¯´Apache SeaTunnel (Incubating)å”¯ä¸€çš„ç¼ºç‚¹å¯èƒ½æ˜¯ç›®å‰ç¼ºå°‘IPçš„è°ƒç”¨ï¼ŒUIç•Œé¢éœ€è¦è‡ªå·±åšç®¡æ§ã€‚</p><p>ç»¼ä¸Šæ‰€è¿°ï¼ŒSqoopè™½ç„¶æ˜¯åˆ†å¸ƒå¼ï¼Œä½†æ˜¯ä»…æ”¯æŒRDBå’ŒHIVEã€Hbaseä¹‹é—´çš„æ•°æ®åŒæ­¥ä¸”æ‰©å±•èƒ½åŠ›å·®ï¼Œä¸åˆ©äºäºŒå¼€ã€‚DataXæ‰©å±•æ€§å¥½ï¼Œæ•´ä½“æ€§ç¨³å®šï¼Œä½†ç”±äºæ˜¯å•æœºç‰ˆï¼Œæ— æ³•åˆ†å¸ƒå¼é›†ç¾¤éƒ¨ç½²ï¼Œä¸”æ•°æ®æŠ½å–èƒ½åŠ›å’Œæœºå™¨æ€§èƒ½æœ‰å¼ºä¾èµ–å…³ç³»ã€‚è€ŒSeaTunnelå’ŒDataXç±»ä¼¼å¹¶å¼¥è¡¥äº†DataXéåˆ†å¸ƒå¼çš„é—®é¢˜ï¼Œå¯¹äºå®æ—¶æµä¹Ÿåšäº†å¾ˆå¥½çš„æ”¯æŒï¼Œè™½ç„¶æ˜¯æ–°äº§å“ï¼Œä½†ç¤¾åŒºæ´»è·ƒåº¦é«˜ã€‚åŸºäºæ˜¯å¦æ”¯æŒåˆ†å¸ƒå¼ã€æ˜¯å¦éœ€è¦å•ç‹¬æœºå™¨éƒ¨ç½²ç­‰è¯¸å¤šå› ç´ çš„è€ƒé‡ï¼Œæœ€åæˆ‘ä»¬é€‰æ‹©äº†SeaTunnelã€‚</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="03-apache-seatunnel-incubatingçš„è½åœ°å®è·µ">03 Apache SeaTunnel (Incubating)çš„è½åœ°å®è·µ<a class="hash-link" href="#03-apache-seatunnel-incubatingçš„è½åœ°å®è·µ" title="Direct link to heading">â€‹</a></h2><p>åœ¨Apache SeaTunnel (Incubating)çš„å®˜ç½‘æˆ‘ä»¬å¯ä»¥çœ‹åˆ°Apache SeaTunnel (Incubating)çš„åŸºç¡€æµç¨‹åŒ…æ‹¬sourceã€transformå’Œsinkä¸‰éƒ¨åˆ†ã€‚æ ¹æ®å®˜ç½‘çš„æŒ‡å—ï¼ŒApache SeaTunnel (Incubating)çš„å¯åŠ¨éœ€è¦é…ç½®è„šæœ¬ï¼Œä½†ç»è¿‡æˆ‘ä»¬çš„ç ”ç©¶å‘ç°ï¼ŒApache SeaTunnel (Incubating)çš„æœ€ç»ˆæ‰§è¡Œæ˜¯ä¾èµ–configæ–‡ä»¶çš„spark-submitæäº¤çš„ä¸€ä¸ªApplicationåº”ç”¨ã€‚</p><p>è¿™ç§åˆå§‹åŒ–æ–¹å¼è™½ç„¶ç®€å•ï¼Œä½†å­˜åœ¨å¿…é¡»ä¾èµ–Configæ–‡ä»¶çš„é—®é¢˜ï¼Œæ¯æ¬¡è¿è¡Œä»»åŠ¡åéƒ½ä¼šç”Ÿæˆå†è¿›è¡Œæ¸…é™¤ï¼Œè™½ç„¶å¯ä»¥åœ¨è°ƒåº¦è„šæœ¬ä¸­åŠ¨æ€ç”Ÿæˆï¼Œä½†ä¹Ÿäº§ç”Ÿäº†ä¸¤ä¸ªé—®é¢˜ã€‚1ã€é¢‘ç¹çš„ç£ç›˜æ“ä½œæ˜¯å¦æœ‰æ„ä¹‰ï¼›2ã€æ˜¯å¦å­˜åœ¨æ›´ä¸ºé«˜æ•ˆçš„æ–¹å¼æ”¯æŒApache SeaTunnel (Incubating)çš„è¿è¡Œã€‚</p><p><img loading="lazy" src="/zh-CN/assets/images/5-94809b2d6f1fbbac48a249728119e5af.png" width="1597" height="973"></p><p>åŸºäºä»¥ä¸Šè€ƒé‡ï¼Œåœ¨æœ€ç»ˆçš„è®¾è®¡æ–¹æ¡ˆä¸­ï¼Œæˆ‘ä»¬å¢åŠ äº†ä¸€ä¸ªç»Ÿä¸€é…ç½®æ¨¡æ¿å¹³å°æ¨¡å—ã€‚è°ƒåº¦æ—¶åªéœ€è¦å‘èµ·ä¸€ä¸ªæäº¤å‘½ä»¤ï¼Œç”±Apache SeaTunnel (Incubating)è‡ªèº«å»ç»Ÿä¸€é…ç½®æ¨¡æ¿å¹³å°ä¸­æ‹‰å–é…ç½®ä¿¡æ¯ï¼Œå†å»è£…è½½å’Œåˆå§‹åŒ–å‚æ•°ã€‚</p><p><img loading="lazy" src="/zh-CN/assets/images/5-1-05477f37c0f5e72755d1335853ea650e.png" width="1496" height="1022"></p><p>ä¸Šå›¾å±•ç¤ºçš„ä¾¿æ˜¯å­©å­ç‹OLAPçš„ä¸šåŠ¡æµç¨‹ï¼Œä¸»è¦åˆ†ä¸ºä¸‰å—ã€‚æ•°æ®ä»Parquetï¼Œå³Hiveï¼Œé€šè¿‡Parquetè¡¨çš„æ–¹å¼åˆ°KYLINå’ŒCK sourceçš„æ•´ä½“æµç¨‹ã€‚</p><p><img loading="lazy" src="/zh-CN/assets/images/7-1317712145fdcaee3b0219f09f68a739.png" width="1205" height="766"></p><p>è¿™æ˜¯æˆ‘ä»¬å»ºæ¨¡çš„é¡µé¢ï¼Œä¸»è¦é€šè¿‡æ‹–æ‹‰æ‹½çš„æ–¹å¼ç”Ÿæˆæœ€ç»ˆæ¨¡å‹ï¼Œæ¯ä¸ªè¡¨ä¹‹é—´é€šè¿‡ä¸€äº›äº¤æ˜“æ“ä½œï¼Œå³ä¾§æ˜¯é’ˆå¯¹Apache SeaTunnel (Incubating)çš„å¾®å¤„ç†ã€‚</p><p><img loading="lazy" src="/zh-CN/assets/images/8-d476fef7e065db158f63dd1b3291543b.jpg" width="1306" height="609"></p><p>å› æ­¤æˆ‘ä»¬æœ€ç»ˆæäº¤çš„å‘½ä»¤å¦‚ä¸Šï¼Œå…¶ä¸­æ ‡çº¢çš„é¦–å…ˆæ˜¯ã€-conf customconfig/jarsã€‘ï¼ŒæŒ‡ç”¨æˆ·å¯ä»¥å†ç»Ÿä¸€é…ç½®æ¨¡æ¿å¹³å°è¿›è¡Œå¤„ç†ï¼Œæˆ–è€…å»ºæ¨¡æ—¶å•ç‹¬æŒ‡å®šã€‚æœ€åæ ‡çº¢çš„ã€421 $start_time $end_time $taskTypeã€‘Unicodeï¼Œå±äºå”¯ä¸€ç¼–ç ã€‚</p><p>ä¸‹æ–¹å›¾å·¦å°±æ˜¯æˆ‘ä»¬æœ€ç»ˆè°ƒåº¦è„šæœ¬æäº¤çš„38ä¸ªå‘½ä»¤ï¼Œä¸‹æ–¹å›¾å³æ˜¯é’ˆå¯¹Apache SeaTunnel (Incubating)åšçš„æ”¹é€ ï¼Œå¯ä»¥çœ‹åˆ°ä¸€ä¸ªè¾ƒä¸ºç‰¹æ®Šçš„åä¸ºWaterdropContextçš„å·¥å…·ç±»ã€‚å¯ä»¥é¦–å…ˆåˆ¤æ–­Unicodeæ˜¯å¦å­˜åœ¨ï¼Œå†é€šè¿‡Unicode_codeæ¥è·å–ä¸åŒæ¨¡æ¿çš„é…ç½®ä¿¡æ¯ï¼Œé¿å…äº†configæ–‡ä»¶çš„æ“ä½œã€‚</p><p>åœ¨æœ€åçš„reportMetaåˆ™æ˜¯ç”¨äºåœ¨ä»»åŠ¡æ‰§è¡Œå®Œæˆåä¸ŠæŠ¥ä¸€äº›ä¿¡æ¯ï¼Œè¿™ä¹Ÿä¼šåœ¨Apache SeaTunnel (Incubating)ä¸­å®Œæˆã€‚</p><p><img loading="lazy" src="/zh-CN/assets/images/9-018ad4a2a0de58d2d3c9c69fffbcd06c.png" width="1136" height="940"></p><p><img loading="lazy" src="/zh-CN/assets/images/10-f0199109244a92f734e89024bef0b51b.png" width="944" height="388"></p><p><img loading="lazy" src="data:image/png;base64,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s7IJECBAgAABAs8QKAuvz5izWRAgQIAAAQIECDQqUBBeu21XR1QbXWZlEyBAgAABAgSeIRANr+cl1y4QO43wjJvJLAgQIECAAAECZwtEw2tXR36s1bFZ87xYfLad/gkQIECAAAECBC4WiIbXbn80fbr6HB64eJEMR4AAAQIECBAgkASi4TW1Tnuux+68WgkCBAgQIECAAAECQYGy8Nrffw0OoBkBAgQIECBAgACBowTKwutRo+Z+bOIeTqpDAgQIECBAgMCDBSqH13yO9sHEpkaAAAECBAgQIHCUQOXwetQ09EOAAAECBAgQIPAGAeH1DatsjgQIECBAgACBhwgIrw9ZSNMgQIAAAQIECLxBQHh9wyqbIwECBAgQIEDgIQLC60MW0jQIECBAgAABAm8QEF7fsMrmSIAAAQIECBB4iIDw+pCFNA0CBAgQIECAwBsETgmv3asHvH3gDXePORIgQIAAAQIELhY4Jbx2rx64eBqGI0CAAAECBAgQeINANLymzdT8eQONORIgQIAAAQIECNxNIBpeu7rTq1y90PVuS6geAgQIECBAgMB7BArC63tQzJQAAQIECBAgQOCeAgXh1ZmBey6hqggQIECAAAEC7xEoCK/5zEDkSQJd40iz90CbKQECBAgQIECAwH6BaHgtfYBAl1xLL9k/GT0QIECAAAECBAg8WyAaXm2jPvs+MDsCBAgQIECAQBMC0fCajgGkjy3VJpZWkQQIECBAgACB5wlEw2s3c8/Jet7ymxEBAgQIECBAoC2BgvAan5gzBnErLQkQIECAAAECBOICp4RXLzKIL4CWBAgQIECAAAECcYFTwmt8eC0JECBAgAABAgQIxAWE17iVlgQIECBAgAABApUFhNfKC2B4AgQIECBAgACBuIDwGrfSkgABAgQIECBAoLKA8Fp5AQxPgAABAgQIECAQFxBe41ZaEiBAgAABAgQIVBYQXisvgOEJECBAgAABAgTiAsJr3EpLAgQIECBAgACBygLCa+UFMDwBAgQIECBAgEBcoCy8du999erXOK6WBAgQIECAAAECxwoUhNcutqb3vsqvx66B3ggQIECAAAECBIIC0fCakmvqNP8QHEMzAgQIECBAgAABAocIRMNrGsyxgUPQdUKAAAECBAgQILBNoCC8OjawjdhVBAgQIECAAAECRwkUhFenBY5C1w8BAgQIECBA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" width="916" height="348"></p><p>åœ¨æœ€ç»ˆå®Œæˆçš„configæ–‡ä»¶å¦‚ä¸Šï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯åœ¨transformæ–¹é¢ï¼Œå­©å­ç‹åšäº†ä¸€äº›æ”¹é€ ã€‚é¦–å…ˆæ˜¯é’ˆå¯¹æ‰‹æœºæˆ–è€…èº«ä»½è¯å·ç­‰åšè„±æ•å¤„ç†ï¼Œå¦‚æœç”¨æˆ·æŒ‡å®šå­—æ®µï¼Œå°±æŒ‰ç…§å­—æ®µåšï¼Œå¦‚æœä¸æŒ‡å®šå­—æ®µå°±æ‰«ææ‰€æœ‰å­—æ®µï¼Œç„¶åæ ¹æ®æ¨¡å¼åŒ¹é…ï¼Œè¿›è¡Œè„±æ•åŠ å¯†ã€‚</p><p>ç¬¬äºŒtransformè¿˜æ”¯æŒè‡ªå®šä¹‰å¤„ç†ï¼Œå¦‚ä¸Šæ–‡è¯´é“OLAPå»ºæ¨¡çš„æ—¶å€™è¯´åˆ°ã€‚åŠ å…¥äº†HideStrï¼Œå¯ä»¥ä¿ç•™ä¸€ä¸²å­—ç¬¦çš„å‰åä¸ªå­—æ®µï¼ŒåŠ å¯†åæ–¹çš„æ‰€æœ‰å­—ç¬¦ï¼Œåœ¨æ•°æ®å®‰å…¨ä¸Šæœ‰æ‰€ä¿éšœã€‚</p><p>ç„¶åï¼Œåœ¨sinkç«¯ï¼Œæˆ‘ä»¬ä¸ºäº†æ”¯æŒä»»åŠ¡çš„å¹‚ç­‰æ€§ï¼Œæˆ‘ä»¬åŠ å…¥äº†pre_sqlï¼Œè¿™ä¸»è¦å®Œæˆçš„ä»»åŠ¡æ˜¯æ•°æ®çš„åˆ é™¤ï¼Œæˆ–åˆ†åŒºçš„åˆ é™¤ï¼Œå› ä¸ºä»»åŠ¡åœ¨ç”Ÿäº§è¿‡ç¨‹ä¸­ä¸å¯èƒ½åªè¿è¡Œä¸€æ¬¡ï¼Œä¸€æ—¦å‡ºç°é‡è·‘æˆ–è¡¥æ•°ç­‰æ“ä½œï¼Œå°±éœ€è¦è¿™ä¸€éƒ¨åˆ†ä¸ºæ•°æ®çš„ä¸åŒå’Œæ­£ç¡®æ€§åšè€ƒé‡ã€‚</p><p>åœ¨å›¾å³æ–¹çš„ä¸€ä¸ªClickhouseçš„Sinkç«¯ï¼Œè¿™é‡Œæˆ‘ä»¬åŠ å…¥äº†ä¸€ä¸ªis_senseless_modeï¼Œå®ƒç»„æˆäº†ä¸€ä¸ªè¯»å†™åˆ†ç¦»çš„æ— æ„Ÿæ¨¡å¼ï¼Œç”¨æˆ·åœ¨æŸ¥è¯¢å’Œè¡¥æ•°çš„æ—¶å€™ä¸æ„ŸçŸ¥æ•´ä½“åŒºåŸŸï¼Œè€Œæ˜¯ç”¨åˆ°CKçš„åˆ†åŒºè½¬æ¢ï¼Œå³åä¸ºMOVE PARTITION TO TABLEçš„å‘½ä»¤è¿›è¡Œæ“ä½œçš„ã€‚</p><p>æ­¤å¤„ç‰¹åˆ«è¯´æ˜KYLINçš„Sinkç«¯ï¼ŒKYLINæ˜¯ä¸€ä¸ªéå¸¸ç‰¹æ®Šçš„æºï¼Œæ‹¥æœ‰è‡ªå·±ä¸€æ•´å¥—æ•°æ®å½•å…¥çš„é€»è¾‘ï¼Œè€Œä¸”ï¼Œä»–æœ‰è‡ªå·±çš„ç›‘æ§é¡µé¢ï¼Œå› æ­¤æˆ‘ä»¬ç»™äºˆKYLINçš„æ”¹é€ åªæ˜¯ç®€å•åœ°è°ƒç”¨å…¶APIæ“ä½œï¼Œåœ¨ä½¿ç”¨KYLINæ—¶ä¹Ÿåªæ˜¯ç®€å•çš„APIè°ƒç”¨å’Œä¸æ–­è½®è¯¢çš„çŠ¶æ€ï¼Œæ‰€ä»¥KYLINè¿™å—çš„èµ„æºåœ¨ç»Ÿä¸€æ¨¡æ¿é…ç½®å¹³å°å°±è¢«é™åˆ¶åœ°å¾ˆå°ã€‚</p><p><img loading="lazy" src="/zh-CN/assets/images/12-61af6fe2e1a38126ec03a0291e15c1bf.jpg" width="1307" height="593"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="04-apache-seatunnel-incubatingæ”¹é€ ä¸­çš„å¸¸è§é—®é¢˜">04 Apache SeaTunnel (Incubating)æ”¹é€ ä¸­çš„å¸¸è§é—®é¢˜<a class="hash-link" href="#04-apache-seatunnel-incubatingæ”¹é€ ä¸­çš„å¸¸è§é—®é¢˜" title="Direct link to heading">â€‹</a></h2><p>1ã€OOM&amp;Too many Parts</p><p>é—®é¢˜é€šå¸¸ä¼šå‡ºç°åœ¨Hiveåˆ°Hiveçš„è¿‡ç¨‹ä¸­ï¼Œå³ä½¿æˆ‘ä»¬é€šè¿‡äº†è‡ªåŠ¨èµ„æºçš„åˆ†é…ï¼Œä½†ä¹Ÿå­˜åœ¨æ•°æ®çªç„¶é—´å˜å¤§çš„æƒ…å†µï¼Œæ¯”å¦‚åœ¨ä¸¾åŠäº†å¤šæ¬¡æ´»åŠ¨ä¹‹åã€‚è¿™æ ·çš„é—®é¢˜å…¶å®åªèƒ½é€šè¿‡æ‰‹åŠ¨åŠ¨æ€åœ°è°ƒå‚ï¼Œè°ƒæ•´æ•°æ®åŒæ­¥æ‰¹é‡æ—¶é—´æ¥é¿å…ã€‚æœªæ¥æˆ‘ä»¬å¯èƒ½å°½åŠ›å»å®Œæˆå¯¹äºæ•°æ®é‡çš„æŒæ¡ï¼Œåšåˆ°ç²¾ç»†çš„æ§åˆ¶ã€‚</p><p>2ã€å­—æ®µã€ç±»å‹ä¸ä¸€è‡´é—®é¢˜</p><p>æ¨¡å‹ä¸Šçº¿åï¼Œä»»åŠ¡ä¾èµ–çš„ä¸Šæ¸¸è¡¨æˆ–è€…å­—æ®µï¼Œç”¨æˆ·éƒ½ä¼šåšä¸€äº›ä¿®æ”¹ï¼Œè¿™äº›ä¿®æ”¹è‹¥æ— æ³•æ„ŸçŸ¥ï¼Œå¯èƒ½å¯¼è‡´ä»»åŠ¡çš„å¤±è´¥ã€‚ç›®å‰è§£å†³æ–¹æ³•æ˜¯ä¾æ‰˜è¡€ç¼˜+å¿«ç…§çš„æ–¹å¼è¿›è¡Œæå‰æ„ŸçŸ¥æ¥é¿å…é”™è¯¯ã€‚</p><p>3ã€è‡ªå®šä¹‰æ•°æ®æº&amp;è‡ªå®šä¹‰åˆ†éš”ç¬¦</p><p>å¦‚è´¢åŠ¡éƒ¨é—¨éœ€è¦å•ç‹¬ä½¿ç”¨çš„åˆ†å‰²ç¬¦ï¼Œæˆ–æ˜¯jarä¿¡æ¯ï¼Œç°åœ¨ç”¨æˆ·å¯ä»¥è‡ªå·±åœ¨ç»Ÿä¸€é…ç½®æ¨¡æ¿å¹³å°æŒ‡å®šåŠ è½½é¢å¤–jarä¿¡æ¯ä»¥åŠåˆ†å‰²ç¬¦ä¿¡æ¯ã€‚</p><p>4ã€æ•°æ®å€¾æ–œé—®é¢˜</p><p>è¿™å¯èƒ½å› ä¸ºç”¨æˆ·è‡ªå·±è®¾ç½®äº†å¹¶è¡Œåº¦ï¼Œä½†æ— æ³•åšåˆ°å°½å–„å°½ç¾ã€‚è¿™ä¸€å—æˆ‘ä»¬æš‚æ—¶è¿˜æ²¡æœ‰å®Œæˆå¤„ç†ï¼Œåç»­çš„æ€è·¯å¯èƒ½åœ¨Sourceæ¨¡å—ä¸­æ·»åŠ postå¤„ç†ï¼Œå¯¹æ•°æ®è¿›è¡Œæ‰“æ•£ï¼Œå®Œæˆå€¾æ–œã€‚</p><p>5ã€KYLINå…¨å±€å­—å…¸é”é—®é¢˜</p><p>éšç€ä¸šåŠ¡å‘å±•ï¼Œä¸€ä¸ªcubeæ— æ³•æ»¡è¶³ç”¨æˆ·ä½¿ç”¨ï¼Œå°±èƒ½éœ€è¦å»ºç«‹å¤šä¸ªcubeï¼Œå¦‚æœå¤šä¸ªcubeä¹‹é—´ç”¨äº†ç›¸åŒçš„å­—æ®µï¼Œå°±ä¼šé‡åˆ°KYLINå…¨å±€å­—å…¸é”çš„é—®é¢˜ã€‚ç›®å‰è§£å†³çš„æ€è·¯æ˜¯æŠŠä¸¤ä¸ªæˆ–å¤šä¸ªä»»åŠ¡ä¹‹é—´çš„è°ƒåº¦æ—¶é—´è¿›è¡Œéš”å¼€ï¼Œå¦‚æœæ— æ³•éš”å¼€ï¼Œå¯ä»¥åšä¸€ä¸ªåˆ†å¸ƒå¼é”çš„æ§åˆ¶ã€‚KYLINçš„sinkç«¯å¿…é¡»è¦æ‹¿åˆ°é”æ‰èƒ½è¿è¡Œã€‚</p><p>05 å¯¹å­©å­ç‹æœªæ¥å‘å±•æ–¹å‘çš„é¢„æµ‹å±•æœ›</p><ul><li><p>å¤šæºæ•°æ®åŒæ­¥ï¼Œæœªæ¥å¯èƒ½é’ˆå¯¹RDBæºè¿›è¡Œå¤„ç†</p></li><li><p>åŸºäºå®æ—¶Flinkçš„å®ç°</p></li><li><p>æ¥ç®¡å·²æœ‰é‡‡é›†è°ƒåº¦å¹³å°ï¼ˆä¸»è¦è§£å†³åˆ†åº“åˆ†è¡¨çš„é—®é¢˜ï¼‰</p></li><li><p>æ•°æ®è´¨é‡æ ¡éªŒï¼Œåƒä¸€äº›ç©ºå€¼ã€æ•´ä¸ªæ•°æ®çš„ç©ºç½®ç‡ã€ä¸»æ—¶é—´çš„åˆ¤æ–­ç­‰</p></li></ul><p>æˆ‘çš„åˆ†äº«å°±åˆ°è¿™é‡Œï¼Œå¸Œæœ›ä»¥åå¯ä»¥å’Œç¤¾åŒºå¤šå¤šäº¤æµï¼Œå…±åŒè¿›æ­¥ï¼Œè°¢è°¢ï¼</p></div></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_rzP5" itemprop="headline"><a itemprop="url" href="/zh-CN/blog/æ™ºèƒ½åŒ–æ—¶ä»£çš„æ•°æ®é›†æˆæŠ€æœ¯é©æ–°">æ™ºèƒ½åŒ–æ—¶ä»£çš„æ•°æ®é›†æˆæŠ€æœ¯é©æ–°</a></h2><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2022-04-08T00:00:00.000Z" itemprop="datePublished">2022å¹´4æœˆ8æ—¥</time> Â· <!-- -->One min read</div></header><div class="markdown" itemprop="articleBody"><p><img loading="lazy" alt="1" src="/zh-CN/assets/images/1-3abb262dd4a58a521e31f7249b2058d2.png" width="900" height="383"></p><p>å¯ç®¡ç†ï¼Œå¯è°ƒç”¨ï¼Œå¯è®¡ç®—ï¼Œå¯å˜ç°çš„æ•°æ®èµ„æºæ‰èƒ½æˆä¸ºèµ„äº§ï¼Œä¿¡æ¯ç³»ç»Ÿçš„äº’è”äº’é€šä½¿å¾—å¤šæºå’Œå¤šç»´åº¦çš„æ•°æ®é›†æˆéœ€æ±‚å·¨å¤§ï¼Œè¿™å°±å¯¹æ•°æ®å¤„ç†å’Œé›†æˆçš„å·¥å…·æå‡ºäº†ä¸¥è‹›çš„è¦æ±‚ã€‚</p><p>æ™ºèƒ½åŒ–æ—¶ä»£ï¼Œåœ¨â€œæ™ºæ…§åŸå¸‚â€ã€â€œæ™ºæ…§æ²»ç†â€ã€â€œäº§å“æ™ºèƒ½åŒ–â€ç­‰çš„è¶‹åŠ¿ä¸‹ï¼Œä¼ä¸šå¤§å¤šé¢ä¸´å¦‚ä½•å®ç°é«˜æ•ˆæ•°æ®æ¨é€ï¼Œæé«˜å¹³å°è´¨é‡ï¼Œä»¥åŠä¿éšœæ•°æ®å®‰å…¨çš„æŒ‘æˆ˜ã€‚é€‰å¯¹æ•°æ®é›†æˆå·¥å…·å’Œå¹³å°ï¼Œæ•°æ®æ‰èƒ½å‘æŒ¥å‡ºåšå¤§çš„ä½œç”¨ã€‚</p><p>Apache SeaTunnel (Incubating) ä½œä¸ºä¸‹ä¸€ä»£é«˜æ€§èƒ½ã€åˆ†å¸ƒå¼ã€æµ·é‡æ•°æ®é›†æˆæ¡†æ¶ï¼Œè‡´åŠ›äºè®©æ•°æ®åŒæ­¥æ›´ç®€å•ï¼Œæ›´é«˜æ•ˆï¼ŒåŠ å¿«åˆ†å¸ƒå¼æ•°æ®å¤„ç†èƒ½åŠ›åœ¨ç”Ÿäº§ç¯å¢ƒè½åœ°ã€‚</p><p>åœ¨ Apache SeaTunnel(Incubating) Meetupï¼ˆ2022Â å¹´Â 4Â æœˆÂ 16æ—¥ï¼‰ï¼ŒApache SeaTunnel(Incubating) ç¤¾åŒºå°†é‚€è¯·äº† Apache SeaTunnel(Incubating)çš„èµ„æ·±ç”¨æˆ·ï¼Œåˆ†äº« Apache SeaTunnel(Incubating)åœ¨æ™ºèƒ½åŒ–ç”Ÿäº§ç¯å¢ƒä¸­è½åœ°çš„æœ€ä½³å®è·µã€‚æ­¤å¤–ï¼Œè¿˜ä¼šæœ‰è´¡çŒ®è€…ç°åœºè¿›è¡Œ Apache SeaTunnel(Incubating)çš„æºç è§£æï¼Œè®©ä½ å¯¹ Apache SeaTunnel(Incubating)æœ‰ä¸€ä¸ªæ›´åŠ å…¨é¢è€Œæ·±å…¥çš„äº†è§£ã€‚</p><p>æ— è®ºä½ æ˜¯å¯¹ Apache SeaTunnel(Incubating)æŠ±æœ‰å…´è¶£çš„åˆå­¦è€…ï¼Œè¿˜æ˜¯åœ¨æ—¥å¸¸çš„ç”Ÿäº§å®è·µä¸­é­é‡äº†å¤æ‚æ£˜æ‰‹çš„éƒ¨ç½²é—®é¢˜ï¼Œéƒ½å¯ä»¥æ¥åˆ°è¿™é‡Œï¼Œä¸æˆ‘ä»¬çš„è®²å¸ˆè¿‘è·ç¦»æ²Ÿé€šï¼Œå¾—åˆ°ä½ æƒ³è¦çš„ç­”æ¡ˆã€‚</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="01-æŠ¥-å-é€š-é“">01 æŠ¥ å é€š é“<a class="hash-link" href="#01-æŠ¥-å-é€š-é“" title="Direct link to heading">â€‹</a></h2><p>Apache SeaTunnel (Incubating) Meetup | 4 æœˆçº¿ä¸Šç›´æ’­æŠ¥åé€šé“å·²å¼€å¯ï¼Œèµ¶å¿«é¢„çº¦å§ï¼</p><p>æ—¶é—´ï¼š2022-4-16 14:00-17:00</p><p>å½¢å¼ï¼šçº¿ä¸Šç›´æ’­</p><p>ç‚¹å‡»é“¾æ¥æˆ–æ‰«ç é¢„çº¦æŠ¥åï¼ˆå…è´¹ï¼‰ï¼š</p><p><img loading="lazy" alt="2" src="/zh-CN/assets/images/2-e9c01734f2c74a12f59e2f3eecd2a2c6.png" width="300" height="300"></p><p>æ‰«ç é¢„çº¦æŠ¥å</p><p><img loading="lazy" alt="3" src="/zh-CN/assets/images/4-b0dd1cb8a1432483e3f3202cbea5c271.png" width="498" height="507"></p><p>æ‰«ç è¿›ç›´æ’­ç¾¤</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="02-æ´»-åŠ¨-äº®-ç‚¹">02 æ´» åŠ¨ äº® ç‚¹<a class="hash-link" href="#02-æ´»-åŠ¨-äº®-ç‚¹" title="Direct link to heading">â€‹</a></h2><ul><li>è¡Œä¸šæ¡ˆä¾‹è¯¦è§£</li><li>ç‰¹è‰²åŠŸèƒ½åˆ†æ</li><li>ä¸€çº¿ä¼ä¸šè¸©å‘å¿ƒå¾—</li><li>å¼€æºç¤¾åŒºå®æˆ˜æ”»ç•¥</li><li>è¡Œä¸šæŠ€æœ¯ä¸“å®¶é¢å¯¹é¢ Q&amp;A</li><li>æƒŠå–œç¤¼å“é€ä¸åœ</li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="03-æ´»-åŠ¨-è®®-ç¨‹">03 æ´» åŠ¨ è®® ç¨‹<a class="hash-link" href="#03-æ´»-åŠ¨-è®®-ç¨‹" title="Direct link to heading">â€‹</a></h2><p>æ´»åŠ¨å½“å¤©ï¼Œå°†æœ‰æ¥è‡ªå­©å­ç‹ã€oppo çš„å·¥ç¨‹å¸ˆç°åœºåˆ†äº«æ¥è‡ªå‚å•†çš„ä¸€çº¿å‰æ²¿å®è·µç»éªŒï¼Œè¿˜æœ‰æ¥è‡ªç™½é²¸å¼€æºçš„é«˜çº§å·¥ç¨‹å¸ˆå¯¹ Apache SeaTunnel(Incubating)çš„é‡è¦åŠŸèƒ½æ›´æ–°è¿›è¡Œâ€œç¡¬æ ¸â€è®²è§£ï¼Œå¹²è´§æ»¡æ»¡ã€‚</p><p><img loading="lazy" alt="4" src="/zh-CN/assets/images/5-f80f0bce07f15e8f83f603d16825dde4.png" width="1080" height="1075"></p><p>è¢æ´ªå†›Â å­©å­ç‹ å¤§æ•°æ®ä¸“å®¶ã€OLAP å¹³å°æ¶æ„å¸ˆ</p><p>å¤šå¹´å¤§æ•°æ®å¹³å°ç ”å‘ç®¡ç†ç»éªŒï¼Œåœ¨æ•°æ®èµ„äº§ã€è¡€ç¼˜å›¾è°±ã€æ•°æ®æ²»ç†ã€OLAP ç­‰é¢†åŸŸæœ‰ç€ä¸°å¯Œçš„ç ”ç©¶ç»éªŒ</p><p>æ¼”è®²æ—¶é—´ï¼š14:00-14:40</p><p>æ¼”è®²é¢˜ç›®ï¼šApache SeaTunnel(Incubating) åœ¨å­©å­ç‹çš„åº”ç”¨å®è·µ</p><p>æ¼”è®²æ¦‚è¦ï¼š å¦‚ä½•å®ç°é«˜æ•ˆæ•°æ®æ¨é€ï¼Ÿå¦‚ä½•æé«˜å¹³å°è´¨é‡ï¼Ÿå¦‚ä½•ä¿éšœæ•°æ®å®‰å…¨ï¼Ÿå­©å­ç‹åˆå¯¹ Apache SeaTunnel(Incubating)åšäº†å“ªäº›æ”¹é€ ï¼Ÿ</p><p><img loading="lazy" alt="6" src="/zh-CN/assets/images/6-8f02c4507ef50d7a109ddf227c45a7a5.png" width="1080" height="1080"></p><p>èŒƒä½³Â ç™½é²¸å¼€æºÂ  é«˜çº§å·¥ç¨‹å¸ˆ Apache SeaTunnel Contributor</p><p>æ¼”è®²æ—¶é—´ï¼š 14:40-15:20</p><p>æ¼”è®²é¢˜ç›®ï¼š åŸºäº Apache SeaTunnel(Incubating)çš„ Clickhouse Bulk Load å®ç°</p><p>æ¼”è®²æ¦‚è¦ï¼š é€šè¿‡æ‰©å±• Apache SeaTunnel(Incubating)çš„ Connectorå®ç° Clickhouseçš„ bulk load æ•°æ®åŒæ­¥åŠŸèƒ½ã€‚</p><p><img loading="lazy" alt="7" src="/zh-CN/assets/images/7-8b4c7798dd107093cb31b526eb3d8476.png" width="1080" height="1078"></p><p>ç‹å­è¶…Â oppoÂ é«˜çº§åç«¯å·¥ç¨‹å¸ˆ</p><p>æ¼”è®²æ—¶é—´ï¼š 15:50-16:30</p><p>æ¼”è®²é¢˜ç›®ï¼š oppoæ™ºèƒ½æ¨èæ ·æœ¬ä¸­å¿ƒåŸºäº Apache SeaTunnel(Incubating)çš„æŠ€æœ¯é©æ–°</p><p>æ¼”è®²æ¦‚è¦ï¼š ä»‹ç» oppo æ™ºèƒ½æ¨èæœºå™¨å­¦ä¹ æ ·æœ¬æµç¨‹çš„æ¼”è¿›åŠ Apache Â SeaTunnel(Incubating)Â åœ¨å…¶ä¸­å‘æŒ¥çš„ä½œç”¨ã€‚</p><p>é™¤äº†ç²¾å½©çš„æ¼”è®²ä¹‹å¤–ï¼Œç°åœºè¿˜è®¾ç½®äº†å¤šä¸ªæŠ½å¥–ç¯èŠ‚ï¼Œå‚ä¸æŠ½å¥–æœ‰æœºä¼šè·å¾—Â ApacheÂ SeaTunnel(Incubating)Â ç²¾ç¾å®šåˆ¶ç¤¼å“ï¼Œæ•¬è¯·æœŸå¾…~</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/zh-CN/blog/tags/meetup">Meetup</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_rzP5" itemprop="headline"><a itemprop="url" href="/zh-CN/blog/2.1.0-Released-Apache-SeaTunnel-Incubating-First-Apache-Release-Refactors-Kernel-and-Supports-Flink-Overall">2.1.0 Released! Apache SeaTunnel(Incubating) First Apache Release Refactors Kernel and Supports Flink Overall</a></h2><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2022-03-18T00:00:00.000Z" itemprop="datePublished">2022å¹´3æœˆ18æ—¥</time> Â· <!-- -->One min read</div></header><div class="markdown" itemprop="articleBody"><p>On December 9, 2021, Apache SeaTunnel(Incubating) entered the Apache Incubator, and after nearly four months of endeavor by the community contributors, we passed the first Apache version control in one go and released it on March 18, 2022. This means that version 2.1.0 is an official release that is safe for corporate and individual users to use, which has been voted on by the Apache SeaTunnel(Incubating) community and the Apache Incubator.</p><p><strong>Note:</strong> AÂ <strong>software license</strong>Â is a legal instrument governing the use or redistribution of software. A typical software license grants theÂ licensee, typically anÂ end-user, permission to use one or more copies of the software in ways where such a use would otherwise potentially constitute copyright infringement of the software owner&#x27;sÂ exclusive rightsÂ under copyright. Effectively, a software license is a contract between the software developer and the user that guarantees the user will not be sued within the scope of the license. </p><p>Before and after entering the incubator, we spent a lot of time sorting through the external dependencies of the entire project to ensure compliance. It is important to note that the choice of License for open source software does not necessarily mean that the project itself is compliant. While the stringent version control process of ASF ensures compliance and legal distribution of the software license maximumly.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="release-note">Release Note<a class="hash-link" href="#release-note" title="Direct link to heading">â€‹</a></h2><p>We bring the following <strong>key features</strong>to this release:</p><ol><li>The kernel of the microkernel plug-in architecture is overall optimized, which is mainly in Java. And a lot of improvements are made to command line parameter parsing, plug-in loading, etc. At the same time, the users (or contributors) can choose the language to develop plug-in extensions, which greatly reduces the development threshold of plug-ins.</li><li>Overall support for Flink, while the users are free to choose the underlying engine. This version also brings a large number of Flink plug-ins and welcomes anyone to contribute more.</li><li>Provide local development fast startup environment support (example), allow contributors or users quickly and smoothly start without changing any code to facilitate rapid local development debugging. This is certainly exciting news for contributors or users who need to customize their plugins. In fact, we&#x27;ve had a large number of contributors use this approach to quickly test the plugin in our pre-release testing.</li><li>With Docker container installation provided, users can deploy and install Apache SeaTunnel(Incubating) via Docker extremely fast, and we will iterate around Docker &amp; K8s in the future, any interesting proposal on this is welcomed.</li></ol><h2 class="anchor anchorWithStickyNavbar_mojV" id="specific-release-notes">Specific release notesï¼š<a class="hash-link" href="#specific-release-notes" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="features">[Features]<a class="hash-link" href="#features" title="Direct link to heading">â€‹</a></h3><ul><li>Use JCommander to do command line parameter parsing, making developers focus on the logic itself.</li><li>Flink is upgraded from 1.9 to 1.13.5, keeping compatibility with older versions and preparing for subsequent CDC.</li><li>Support for Doris, Hudi, Phoenix, Druid, and other Connector plugins, and you can find complete plugin support here <a href="/zh-CN/blog/page/[https://github.com/apache/incubator-seatunnel#plugins-supported-by-seatunnel%5D(https://github.com/apache/incubator-seatunnel#plugins-supported-by-seatunnel)">plugins-supported-by-seatunnel</a>.</li><li>Local development extremely fast starts environment support. It can be achieved by using the example module without modifying any code, which is convenient for local debugging.</li><li>Support for installing and trying out Apache SeaTunnel(Incubating) via Docker containers.</li><li>SQL component supports SET statements and configuration variables.</li><li>Config module refactoring to facilitate understanding for the contributors while ensuring code compliance (License) of the project.</li><li>Project structure realigned to fit the new Roadmap.</li><li>CI&amp;CD support, code quality automation control (more plans will be carried out to support CI&amp;CD development).</li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="acknowledgments">Acknowledgments<a class="hash-link" href="#acknowledgments" title="Direct link to heading">â€‹</a></h2><p>Thanks to the following contributors who participated in this version release (GitHub IDs, in no particular order).</p><p>Al-assad, BenJFan, CalvinKirs, JNSimba, JiangTChen, Rianico, TyrantLucifer, Yves-yuan, ZhangchengHu0923, agendazhang, an-shi-chi-fan, asdf2014, bigdataf, chaozwn, choucmei, dailidong, dongzl, felix-thinkingdata, fengyuceNv, garyelephant, kalencaya, kezhenxu94, legendtkl, leo65535, liujinhui1994, mans2singh, marklightning, mosence, nielifeng, ououtt, ruanwenjun, simon824, totalo, wntp, wolfboys, wuchunfu, xbkaishui, xtr1993, yx91490, zhangbutao, zhaomin1423, zhongjiajie, zhuangchong, zixi0825.</p><p>Also sincere gratitude to our Mentors: Zhenxu Ke, Willem Jiang, William Guo, LiDong Dai, Ted Liu, Kevin, JB for their help!</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="planning-for-the-next-few-releases">Planning for the next few releases:<a class="hash-link" href="#planning-for-the-next-few-releases" title="Direct link to heading">â€‹</a></h2><ul><li>CDC support.</li><li>Support for the monitoring system.</li><li>UI system support.</li><li>More Connector and efficient Sink support, such as ClickHouse support will be available in the next release soon.
The follow-up <strong>Features</strong> are decided by the community consensus, and we sincerely appeal to more participation in the community construction.</li></ul><p>We need your attention and contributions:)</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="community-status">Community Status<a class="hash-link" href="#community-status" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="recent-development">Recent Development<a class="hash-link" href="#recent-development" title="Direct link to heading">â€‹</a></h3><p>Since entering the Apache incubator, the contributor group has grown from 13 to 55 and continues to grow, with the average weekly community commits remaining at 20+. </p><p>Three contributors from different companies (Lei Xie, HuaJie Wang, Chunfu Wu) have been invited to become Committers on account of their contributions to the community. </p><p>We held two Meetups, where instructors from Bilibili, OPPO, Vipshop, and other companies shared their large-scale production practices based on SeaTunnel in their companies (we will hold one meetup monthly in the future, and welcome SeaTunnel users or contributors to come and share their stories about SeaTunnel).</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="users-of-apache-seatunnelincubating">Users of Apache SeaTunnel(Incubating)<a class="hash-link" href="#users-of-apache-seatunnelincubating" title="Direct link to heading">â€‹</a></h3><p>Note: Only registered users are included.</p><p>Registered users of Apache SeaTunnel(Incubating) are shown below. If you are also using Apache SeaTunnel(Incubating), too, welcome to register on <a href="https://github.com/apache/incubator-seatunnel/issues/686" target="_blank" rel="noopener noreferrer">Who is using SeaTunne</a>!</p><div align="center"><img src="/image/20220321/1.png"></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="ppmcs-word">PPMC&#x27;s Word<a class="hash-link" href="#ppmcs-word" title="Direct link to heading">â€‹</a></h2><p>LiFeng Nie, PPMC of Apache SeaTunnel(Incubating), commented on the first Apache version release. </p><p>From the first day entering Apache Incubating, we have been working hard to learn the Apache Way and various Apache policies. Although the first release took a lot of time (mainly for compliance), we think it was well worth it, and that&#x27;s one of the reasons we chose to enter Apache. We need to give our users peace of mind, and Apache is certainly the best choice, with its almost demanding license control that allows users to avoid compliance issues as much as possible and ensure that the software is circulating reasonably and legally. In addition, its practice of the Apache Way, such as public service mission, pragmatism, community over code, openness and consensus decision-making, and meritocracy, can drive the Apache SeaTunnel(Incubating) community to become more open, transparent, and diverse.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/zh-CN/blog/tags/2-1-0">2.1.0</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/zh-CN/blog/tags/release">Release</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_rzP5" itemprop="headline"><a itemprop="url" href="/zh-CN/blog/hdfs-to-clickhouse">å¦‚ä½•å¿«é€Ÿåœ°æŠŠ HDFS ä¸­çš„æ•°æ®å¯¼å…¥ ClickHouse</a></h2><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2021-12-30T00:00:00.000Z" itemprop="datePublished">2021å¹´12æœˆ30æ—¥</time> Â· <!-- -->One min read</div></header><div class="markdown" itemprop="articleBody"><p>ClickHouse æ˜¯é¢å‘ OLAP çš„åˆ†å¸ƒå¼åˆ—å¼ DBMSã€‚æˆ‘ä»¬éƒ¨é—¨ç›®å‰å·²ç»æŠŠæ‰€æœ‰æ•°æ®åˆ†æç›¸å…³çš„æ—¥å¿—æ•°æ®å­˜å‚¨è‡³ ClickHouse è¿™ä¸ªä¼˜ç§€çš„æ•°æ®ä»“åº“ä¹‹ä¸­ï¼Œå½“å‰æ—¥æ•°æ®é‡è¾¾åˆ°äº† 300 äº¿ã€‚</p><p>ä¹‹å‰ä»‹ç»çš„æœ‰å…³æ•°æ®å¤„ç†å…¥åº“çš„ç»éªŒéƒ½æ˜¯åŸºäºå®æ—¶æ•°æ®æµï¼Œæ•°æ®å­˜å‚¨åœ¨ Kafka ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ Java æˆ–è€… Golang å°†æ•°æ®ä» Kafka ä¸­è¯»å–ã€è§£æã€æ¸…æ´—ä¹‹åå†™å…¥ ClickHouse ä¸­ï¼Œè¿™æ ·å¯ä»¥å®ç°æ•°æ®çš„å¿«é€Ÿæ¥å…¥ã€‚ç„¶è€Œåœ¨å¾ˆå¤šåŒå­¦çš„ä½¿ç”¨åœºæ™¯ä¸­ï¼Œæ•°æ®éƒ½ä¸æ˜¯å®æ—¶çš„ï¼Œå¯èƒ½éœ€è¦å°† HDFS æˆ–è€…æ˜¯ Hive ä¸­çš„æ•°æ®å¯¼å…¥ ClickHouseã€‚æœ‰çš„åŒå­¦é€šè¿‡ç¼–å†™ Spark ç¨‹åºæ¥å®ç°æ•°æ®çš„å¯¼å…¥ï¼Œé‚£ä¹ˆæ˜¯å¦æœ‰æ›´ç®€å•ã€é«˜æ•ˆçš„æ–¹æ³•å‘¢ã€‚</p><p>ç›®å‰å¼€æºç¤¾åŒºä¸Šæœ‰ä¸€æ¬¾å·¥å…· <strong>Seatunnel</strong>ï¼Œé¡¹ç›®åœ°å€ <a href="https://github.com/apache/incubator-seatunnel" target="_blank" rel="noopener noreferrer">https://github.com/apache/incubator-seatunnel</a>ï¼Œå¯ä»¥å¿«é€Ÿåœ°å°† HDFS ä¸­çš„æ•°æ®å¯¼å…¥ ClickHouseã€‚</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="hdfs-to-clickhouse">HDFS To ClickHouse<a class="hash-link" href="#hdfs-to-clickhouse" title="Direct link to heading">â€‹</a></h2><p>å‡è®¾æˆ‘ä»¬çš„æ—¥å¿—å­˜å‚¨åœ¨ HDFS ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å°†æ—¥å¿—è¿›è¡Œè§£æå¹¶ç­›é€‰å‡ºæˆ‘ä»¬å…³å¿ƒçš„å­—æ®µï¼Œå°†å¯¹åº”çš„å­—æ®µå†™å…¥ ClickHouse çš„è¡¨ä¸­ã€‚</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="log-sample">Log Sample<a class="hash-link" href="#log-sample" title="Direct link to heading">â€‹</a></h3><p>æˆ‘ä»¬åœ¨ HDFS ä¸­å­˜å‚¨çš„æ—¥å¿—æ ¼å¼å¦‚ä¸‹ï¼Œ æ˜¯å¾ˆå¸¸è§çš„ Nginx æ—¥å¿—</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token number">10.41</span><span class="token plain">.1.28 github.com </span><span class="token number">114.250</span><span class="token plain">.140.241 </span><span class="token number">0</span><span class="token plain">.001s </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;127.0.0.1:80&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">26</span><span class="token plain">/Oct/2018:03:09:32 +0800</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;GET /Apache/Seatunnel HTTP/1.1&quot;</span><span class="token plain"> </span><span class="token number">200</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;-&quot;</span><span class="token plain"> - </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Dalvik/2.1.0 (Linux; U; Android 7.1.1; OPPO R11 Build/NMF26X)&quot;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;196&quot;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;-&quot;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;mainpage&quot;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;443&quot;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;-&quot;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;172.16.181.129&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="clickhouse-schema">ClickHouse Schema<a class="hash-link" href="#clickhouse-schema" title="Direct link to heading">â€‹</a></h3><p>æˆ‘ä»¬çš„ ClickHouse å»ºè¡¨è¯­å¥å¦‚ä¸‹ï¼Œæˆ‘ä»¬çš„è¡¨æŒ‰æ—¥è¿›è¡Œåˆ†åŒº</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">CREATE TABLE cms.cms_msg</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">date</span><span class="token plain"> Date, </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    datetime DateTime, </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    url String, </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    request_time Float32, </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    status String, </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">hostname</span><span class="token plain"> String, </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    domain String, </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    remote_addr String, </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    data_size Int32, </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    pool String</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> ENGINE </span><span class="token operator">=</span><span class="token plain"> MergeTree PARTITION BY </span><span class="token function" style="color:rgb(80, 250, 123)">date</span><span class="token plain"> ORDER BY </span><span class="token function" style="color:rgb(80, 250, 123)">date</span><span class="token plain"> SETTINGS index_granularity </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">16384</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="seatunnel-with-clickhouse">Seatunnel with ClickHouse<a class="hash-link" href="#seatunnel-with-clickhouse" title="Direct link to heading">â€‹</a></h2><p>æ¥ä¸‹æ¥ä¼šç»™å¤§å®¶è¯¦ç»†ä»‹ç»ï¼Œæˆ‘ä»¬å¦‚ä½•é€šè¿‡ Seatunnel æ»¡è¶³ä¸Šè¿°éœ€æ±‚ï¼Œå°† HDFS ä¸­çš„æ•°æ®å†™å…¥ ClickHouse ä¸­ã€‚</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="seatunnel">Seatunnel<a class="hash-link" href="#seatunnel" title="Direct link to heading">â€‹</a></h3><p><a href="https://github.com/apache/incubator-seatunnel" target="_blank" rel="noopener noreferrer">Seatunnel</a> æ˜¯ä¸€ä¸ªéå¸¸æ˜“ç”¨ï¼Œé«˜æ€§èƒ½ï¼Œèƒ½å¤Ÿåº”å¯¹æµ·é‡æ•°æ®çš„å®æ—¶æ•°æ®å¤„ç†äº§å“ï¼Œå®ƒæ„å»ºåœ¨Sparkä¹‹ä¸Šã€‚Seatunnel æ‹¥æœ‰ç€éå¸¸ä¸°å¯Œçš„æ’ä»¶ï¼Œæ”¯æŒä» Kafkaã€HDFSã€Kudu ä¸­è¯»å–æ•°æ®ï¼Œè¿›è¡Œå„ç§å„æ ·çš„æ•°æ®å¤„ç†ï¼Œå¹¶å°†ç»“æœå†™å…¥ ClickHouseã€Elasticsearch æˆ–è€… Kafka ä¸­ã€‚</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="prerequisites">Prerequisites<a class="hash-link" href="#prerequisites" title="Direct link to heading">â€‹</a></h3><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦å®‰è£… Seatunnelï¼Œå®‰è£…ååˆ†ç®€å•ï¼Œæ— éœ€é…ç½®ç³»ç»Ÿç¯å¢ƒå˜é‡</p><ol><li>å‡†å¤‡ Spark ç¯å¢ƒ</li><li>å®‰è£… Seatunnel</li><li>é…ç½® Seatunnel</li></ol><p>ä»¥ä¸‹æ˜¯ç®€æ˜“æ­¥éª¤ï¼Œå…·ä½“å®‰è£…å¯ä»¥å‚ç…§ <a href="/zh-CN/docs/quick-start">Quick Start</a></p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token builtin class-name" style="color:rgb(189, 147, 249)">cd</span><span class="token plain"> /usr/local</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">wget</span><span class="token plain"> https://archive.apache.org/dist/spark/spark-2.2.0/spark-2.2.0-bin-hadoop2.7.tgz</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">tar</span><span class="token plain"> -xvf https://archive.apache.org/dist/spark/spark-2.2.0/spark-2.2.0-bin-hadoop2.7.tgz</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">wget</span><span class="token plain"> https://github.com/InterestingLab/seatunnel/releases/download/v1.1.1/seatunnel-1.1.1.zip</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">unzip</span><span class="token plain"> seatunnel-1.1.1.zip</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">cd</span><span class="token plain"> seatunnel-1.1.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">vim</span><span class="token plain"> config/seatunnel-env.sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># æŒ‡å®šSparkå®‰è£…è·¯å¾„</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">SPARK_HOME</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${SPARK_HOME</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">:-</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">/</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">usr</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">/</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">local</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">/</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">spark-2.2.0-bin-hadoop2.7}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="seatunnel-pipeline">seatunnel Pipeline<a class="hash-link" href="#seatunnel-pipeline" title="Direct link to heading">â€‹</a></h3><p>æˆ‘ä»¬ä»…éœ€è¦ç¼–å†™ä¸€ä¸ª seatunnel Pipeline çš„é…ç½®æ–‡ä»¶å³å¯å®Œæˆæ•°æ®çš„å¯¼å…¥ã€‚</p><p>é…ç½®æ–‡ä»¶åŒ…æ‹¬å››ä¸ªéƒ¨åˆ†ï¼Œåˆ†åˆ«æ˜¯ Sparkã€Inputã€filter å’Œ Outputã€‚</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="spark">Spark<a class="hash-link" href="#spark" title="Direct link to heading">â€‹</a></h4><p>è¿™ä¸€éƒ¨åˆ†æ˜¯ Spark çš„ç›¸å…³é…ç½®ï¼Œä¸»è¦é…ç½® Spark æ‰§è¡Œæ—¶æ‰€éœ€çš„èµ„æºå¤§å°ã€‚</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">spark </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.app.name </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;seatunnel&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.executor.instances </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.executor.cores </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.executor.memory </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;1g&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="input">Input<a class="hash-link" href="#input" title="Direct link to heading">â€‹</a></h4><p>è¿™ä¸€éƒ¨åˆ†å®šä¹‰æ•°æ®æºï¼Œå¦‚ä¸‹æ˜¯ä» HDFS æ–‡ä»¶ä¸­è¯»å– text æ ¼å¼æ•°æ®çš„é…ç½®æ¡ˆä¾‹ã€‚</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">input </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    hdfs </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        path </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;hdfs://nomanode:8020/rowlog/accesslog&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        table_name </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;access_log&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token function" style="color:rgb(80, 250, 123)">format</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;text&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="filter">Filter<a class="hash-link" href="#filter" title="Direct link to heading">â€‹</a></h4><p>åœ¨ Filter éƒ¨åˆ†ï¼Œè¿™é‡Œæˆ‘ä»¬é…ç½®ä¸€ç³»åˆ—çš„è½¬åŒ–ï¼ŒåŒ…æ‹¬æ­£åˆ™è§£æå°†æ—¥å¿—è¿›è¡Œæ‹†åˆ†ã€æ—¶é—´è½¬æ¢å°† HTTPDATE è½¬åŒ–ä¸º ClickHouse æ”¯æŒçš„æ—¥æœŸæ ¼å¼ã€å¯¹ Number ç±»å‹çš„å­—æ®µè¿›è¡Œç±»å‹è½¬æ¢ä»¥åŠé€šè¿‡ SQL è¿›è¡Œå­—æ®µç­›å‡ç­‰</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">filter </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># ä½¿ç”¨æ­£åˆ™è§£æåŸå§‹æ—¥å¿—</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    grok </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        source_field </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;raw_message&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        pattern </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;%{IP:ha_ip}\\s%{NOTSPACE:domain}\\s%{IP:remote_addr}\\s%{NUMBER:request_time}s\\s\&quot;%{DATA:upstream_ip}\&quot;\\s\\[%{HTTPDATE:timestamp}\\]\\s\&quot;%{NOTSPACE:method}\\s%{DATA:url}\\s%{NOTSPACE:http_ver}\&quot;\\s%{NUMBER:status}\\s%{NUMBER:body_bytes_send}\\s%{DATA:referer}\\s%{NOTSPACE:cookie_info}\\s\&quot;%{DATA:user_agent}\&quot;\\s%{DATA:uid}\\s%{DATA:session_id}\\s\&quot;%{DATA:pool}\&quot;\\s\&quot;%{DATA:tag2}\&quot;\\s%{DATA:tag3}\\s%{DATA:tag4}&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># å°†&quot;dd/MMM/yyyy:HH:mm:ss Z&quot;æ ¼å¼çš„æ•°æ®è½¬æ¢ä¸º</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># &quot;yyyy/MM/dd HH:mm:ss&quot;æ ¼å¼çš„æ•°æ®</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">date</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        source_field </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;timestamp&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        target_field </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;datetime&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        source_time_format </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;dd/MMM/yyyy:HH:mm:ss Z&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        target_time_format </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;yyyy/MM/dd HH:mm:ss&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># ä½¿ç”¨SQLç­›é€‰å…³æ³¨çš„å­—æ®µï¼Œå¹¶å¯¹å­—æ®µè¿›è¡Œå¤„ç†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># ç”šè‡³å¯ä»¥é€šè¿‡è¿‡æ»¤æ¡ä»¶è¿‡æ»¤æ‰ä¸å…³å¿ƒçš„æ•°æ®</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    sql </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        table_name </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;access&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        sql </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;select substring(date, 1, 10) as date, datetime, hostname, url, http_code, float(request_time), int(data_size), domain from access&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="output">Output<a class="hash-link" href="#output" title="Direct link to heading">â€‹</a></h4><p>æœ€åæˆ‘ä»¬å°†å¤„ç†å¥½çš„ç»“æ„åŒ–æ•°æ®å†™å…¥ ClickHouse</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">output </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    clickhouse </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token function" style="color:rgb(80, 250, 123)">host</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;your.clickhouse.host:8123&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        database </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;seatunnel&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        table </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;access_log&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        fields </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;date&quot;</span><span class="token plain">, </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;datetime&quot;</span><span class="token plain">, </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;hostname&quot;</span><span class="token plain">, </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;uri&quot;</span><span class="token plain">, </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;http_code&quot;</span><span class="token plain">, </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;request_time&quot;</span><span class="token plain">, </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;data_size&quot;</span><span class="token plain">, </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;domain&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        username </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;username&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        password </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;password&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="running-seatunnel">Running seatunnel<a class="hash-link" href="#running-seatunnel" title="Direct link to heading">â€‹</a></h3><p>æˆ‘ä»¬å°†ä¸Šè¿°å››éƒ¨åˆ†é…ç½®ç»„åˆæˆä¸ºæˆ‘ä»¬çš„é…ç½®æ–‡ä»¶ <code>config/batch.conf</code>ã€‚</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">vim</span><span class="token plain"> config/batch.conf</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">spark </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.app.name </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;seatunnel&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.executor.instances </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.executor.cores </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.executor.memory </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;1g&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">input </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    hdfs </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        path </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;hdfs://nomanode:8020/rowlog/accesslog&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        table_name </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;access_log&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token function" style="color:rgb(80, 250, 123)">format</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;text&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">filter </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># ä½¿ç”¨æ­£åˆ™è§£æåŸå§‹æ—¥å¿—</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    grok </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        source_field </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;raw_message&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        pattern </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;%{IP:ha_ip}\\s%{NOTSPACE:domain}\\s%{IP:remote_addr}\\s%{NUMBER:request_time}s\\s\&quot;%{DATA:upstream_ip}\&quot;\\s\\[%{HTTPDATE:timestamp}\\]\\s\&quot;%{NOTSPACE:method}\\s%{DATA:url}\\s%{NOTSPACE:http_ver}\&quot;\\s%{NUMBER:status}\\s%{NUMBER:body_bytes_send}\\s%{DATA:referer}\\s%{NOTSPACE:cookie_info}\\s\&quot;%{DATA:user_agent}\&quot;\\s%{DATA:uid}\\s%{DATA:session_id}\\s\&quot;%{DATA:pool}\&quot;\\s\&quot;%{DATA:tag2}\&quot;\\s%{DATA:tag3}\\s%{DATA:tag4}&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># å°†&quot;dd/MMM/yyyy:HH:mm:ss Z&quot;æ ¼å¼çš„æ•°æ®è½¬æ¢ä¸º</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># &quot;yyyy/MM/dd HH:mm:ss&quot;æ ¼å¼çš„æ•°æ®</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">date</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        source_field </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;timestamp&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        target_field </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;datetime&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        source_time_format </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;dd/MMM/yyyy:HH:mm:ss Z&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        target_time_format </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;yyyy/MM/dd HH:mm:ss&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># ä½¿ç”¨SQLç­›é€‰å…³æ³¨çš„å­—æ®µï¼Œå¹¶å¯¹å­—æ®µè¿›è¡Œå¤„ç†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># ç”šè‡³å¯ä»¥é€šè¿‡è¿‡æ»¤æ¡ä»¶è¿‡æ»¤æ‰ä¸å…³å¿ƒçš„æ•°æ®</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    sql </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        table_name </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;access&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        sql </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;select substring(date, 1, 10) as date, datetime, hostname, url, http_code, float(request_time), int(data_size), domain from access&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">output </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    clickhouse </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token function" style="color:rgb(80, 250, 123)">host</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;your.clickhouse.host:8123&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        database </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;seatunnel&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        table </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;access_log&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        fields </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;date&quot;</span><span class="token plain">, </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;datetime&quot;</span><span class="token plain">, </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;hostname&quot;</span><span class="token plain">, </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;uri&quot;</span><span class="token plain">, </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;http_code&quot;</span><span class="token plain">, </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;request_time&quot;</span><span class="token plain">, </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;data_size&quot;</span><span class="token plain">, </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;domain&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        username </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;username&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        password </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;password&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>æ‰§è¡Œå‘½ä»¤ï¼ŒæŒ‡å®šé…ç½®æ–‡ä»¶ï¼Œè¿è¡Œ Seatunnelï¼Œå³å¯å°†æ•°æ®å†™å…¥ ClickHouseã€‚è¿™é‡Œæˆ‘ä»¬ä»¥æœ¬åœ°æ¨¡å¼ä¸ºä¾‹ã€‚</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">./bin/start-seatunnel.sh --config config/batch.conf -e client -m </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;local[2]&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="conclusion">Conclusion<a class="hash-link" href="#conclusion" title="Direct link to heading">â€‹</a></h2><p>åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨ Seatunnel å°† HDFS ä¸­çš„ Nginx æ—¥å¿—æ–‡ä»¶å¯¼å…¥ ClickHouse ä¸­ã€‚ä»…é€šè¿‡ä¸€ä¸ªé…ç½®æ–‡ä»¶ä¾¿å¯å¿«é€Ÿå®Œæˆæ•°æ®çš„å¯¼å…¥ï¼Œæ— éœ€ç¼–å†™ä»»ä½•ä»£ç ã€‚é™¤äº†æ”¯æŒ HDFS æ•°æ®æºä¹‹å¤–ï¼ŒSeatunnel åŒæ ·æ”¯æŒå°†æ•°æ®ä» Kafka ä¸­å®æ—¶è¯»å–å¤„ç†å†™å…¥ ClickHouse ä¸­ã€‚æˆ‘ä»¬çš„ä¸‹ä¸€ç¯‡æ–‡ç« å°†ä¼šä»‹ç»ï¼Œå¦‚ä½•å°† Hive ä¸­çš„æ•°æ®å¿«é€Ÿå¯¼å…¥ ClickHouse ä¸­ã€‚</p><p>å½“ç„¶ï¼ŒSeatunnel ä¸ä»…ä»…æ˜¯ ClickHouse æ•°æ®å†™å…¥çš„å·¥å…·ï¼Œåœ¨ Elasticsearch ä»¥åŠ Kafkaç­‰ æ•°æ®æºçš„å†™å…¥ä¸ŠåŒæ ·å¯ä»¥æ‰®æ¼”ç›¸å½“é‡è¦çš„è§’è‰²ã€‚</p><p>å¸Œæœ›äº†è§£ Seatunnel å’Œ ClickHouseã€Elasticsearchã€Kafka ç»“åˆä½¿ç”¨çš„æ›´å¤šåŠŸèƒ½å’Œæ¡ˆä¾‹ï¼Œå¯ä»¥ç›´æ¥è¿›å…¥å®˜ç½‘ <a href="https://seatunnel.apache.org/" target="_blank" rel="noopener noreferrer">https://seatunnel.apache.org/</a></p><p>-- Power by <a href="https://github.com/InterestingLab" target="_blank" rel="noopener noreferrer">InterestingLab</a></p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/zh-CN/blog/tags/hdfs">HDFS</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/zh-CN/blog/tags/click-house">ClickHouse</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_rzP5" itemprop="headline"><a itemprop="url" href="/zh-CN/blog/hive-to-clickhouse">å¦‚ä½•å¿«é€Ÿåœ°æŠŠ Hive ä¸­çš„æ•°æ®å¯¼å…¥ ClickHouse</a></h2><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2021-12-30T00:00:00.000Z" itemprop="datePublished">2021å¹´12æœˆ30æ—¥</time> Â· <!-- -->One min read</div></header><div class="markdown" itemprop="articleBody"><p>ClickHouseæ˜¯é¢å‘OLAPçš„åˆ†å¸ƒå¼åˆ—å¼DBMSã€‚æˆ‘ä»¬éƒ¨é—¨ç›®å‰å·²ç»æŠŠæ‰€æœ‰æ•°æ®åˆ†æç›¸å…³çš„æ—¥å¿—æ•°æ®å­˜å‚¨è‡³ClickHouseè¿™ä¸ªä¼˜ç§€çš„æ•°æ®ä»“åº“ä¹‹ä¸­ï¼Œå½“å‰æ—¥æ•°æ®é‡è¾¾åˆ°äº†300äº¿ã€‚</p><p>åœ¨ä¹‹å‰çš„æ–‡ç«  <a href="/zh-CN/blog/page/i18n/zh-CN/docusaurus-plugin-content-blog/current/2021-12-30-hdfs-to-clickhouse.mdtent-blog/current/2021-12-30-hdfs-to-clickhouse.md">å¦‚ä½•å¿«é€Ÿåœ°æŠŠHDFSä¸­çš„æ•°æ®å¯¼å…¥ClickHouse</a> ä¸­æˆ‘ä»¬æåˆ°è¿‡ä½¿ç”¨ Seatunnel <a href="https://github.com/apache/incubator-seatunnel" target="_blank" rel="noopener noreferrer">https://github.com/apache/incubator-seatunnel</a> å¯¹HDFSä¸­çš„æ•°æ®ç»è¿‡å¾ˆç®€å•çš„æ“ä½œå°±å¯ä»¥å°†æ•°æ®å†™å…¥ClickHouseã€‚HDFSä¸­çš„æ•°æ®ä¸€èˆ¬æ˜¯éç»“æ„åŒ–çš„æ•°æ®ï¼Œé‚£ä¹ˆé’ˆå¯¹å­˜å‚¨åœ¨Hiveä¸­çš„ç»“æ„åŒ–æ•°æ®ï¼Œæˆ‘ä»¬åº”è¯¥æ€ä¹ˆæ“ä½œå‘¢ï¼Ÿ</p><p><img loading="lazy" src="/zh-CN/assets/images/hive-logo-c9aedd90b5ea9668c87fe25ad92a8e6c.png" width="962" height="518"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="hive-to-clickhouse">Hive to ClickHouse<a class="hash-link" href="#hive-to-clickhouse" title="Direct link to heading">â€‹</a></h2><p>å‡å®šæˆ‘ä»¬çš„æ•°æ®å·²ç»å­˜å‚¨åœ¨Hiveä¸­ï¼Œæˆ‘ä»¬éœ€è¦è¯»å–Hiveè¡¨ä¸­çš„æ•°æ®å¹¶ç­›é€‰å‡ºæˆ‘ä»¬å…³å¿ƒçš„å­—æ®µï¼Œæˆ–è€…å¯¹å­—æ®µè¿›è¡Œè½¬æ¢ï¼Œæœ€åå°†å¯¹åº”çš„å­—æ®µå†™å…¥ClickHouseçš„è¡¨ä¸­ã€‚</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="hive-schema">Hive Schema<a class="hash-link" href="#hive-schema" title="Direct link to heading">â€‹</a></h3><p>æˆ‘ä»¬åœ¨Hiveä¸­å­˜å‚¨çš„æ•°æ®è¡¨ç»“æ„å¦‚ä¸‹ï¼Œå­˜å‚¨çš„æ˜¯å¾ˆå¸¸è§çš„Nginxæ—¥å¿—</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">CREATE TABLE `nginx_msg_detail`(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   `hostname` string,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   `domain` string,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   `remote_addr` string,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   `request_time` float,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   `datetime` string,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   `url` string,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   `status` int,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   `data_size` int,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   `referer` string,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   `cookie_info` string,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   `user_agent` string,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   `minute` string)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> PARTITIONED BY (</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   `date` string,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   `hour` string)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="clickhouse-schema">ClickHouse Schema<a class="hash-link" href="#clickhouse-schema" title="Direct link to heading">â€‹</a></h3><p>æˆ‘ä»¬çš„ClickHouseå»ºè¡¨è¯­å¥å¦‚ä¸‹ï¼Œæˆ‘ä»¬çš„è¡¨æŒ‰æ—¥è¿›è¡Œåˆ†åŒº</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">CREATE TABLE cms.cms_msg</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    date Date,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    datetime DateTime,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    url String,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    request_time Float32,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    status String,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    hostname String,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    domain String,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    remote_addr String,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    data_size Int32</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">) ENGINE = MergeTree PARTITION BY date ORDER BY (date, hostname) SETTINGS index_granularity = 16384</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="seatunnel-with-clickhouse">Seatunnel with ClickHouse<a class="hash-link" href="#seatunnel-with-clickhouse" title="Direct link to heading">â€‹</a></h2><p>æ¥ä¸‹æ¥ä¼šç»™å¤§å®¶ä»‹ç»ï¼Œæˆ‘ä»¬å¦‚ä½•é€šè¿‡ Seatunnel å°†Hiveä¸­çš„æ•°æ®å†™å…¥ClickHouseä¸­ã€‚</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="seatunnel">Seatunnel<a class="hash-link" href="#seatunnel" title="Direct link to heading">â€‹</a></h3><p><a href="https://github.com/apache/incubator-seatunnel" target="_blank" rel="noopener noreferrer">Seatunnel</a> æ˜¯ä¸€ä¸ªéå¸¸æ˜“ç”¨ï¼Œé«˜æ€§èƒ½ï¼Œèƒ½å¤Ÿåº”å¯¹æµ·é‡æ•°æ®çš„å®æ—¶æ•°æ®å¤„ç†äº§å“ï¼Œå®ƒæ„å»ºåœ¨Sparkä¹‹ä¸Šã€‚Seatunnel æ‹¥æœ‰ç€éå¸¸ä¸°å¯Œçš„æ’ä»¶ï¼Œæ”¯æŒä»Kafkaã€HDFSã€Kuduä¸­è¯»å–æ•°æ®ï¼Œè¿›è¡Œå„ç§å„æ ·çš„æ•°æ®å¤„ç†ï¼Œå¹¶å°†ç»“æœå†™å…¥ClickHouseã€Elasticsearchæˆ–è€…Kafkaä¸­ã€‚</p><p>Seatunnelçš„ç¯å¢ƒå‡†å¤‡ä»¥åŠå®‰è£…æ­¥éª¤è¿™é‡Œå°±ä¸ä¸€ä¸€èµ˜è¿°äº†ï¼Œå…·ä½“å®‰è£…æ­¥éª¤å¯ä»¥å‚è€ƒä¸Šä¸€ç¯‡æ–‡ç« æˆ–è€…è®¿é—® <a href="/zh-CN/docs/intro/about">Seatunnel Docs</a></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="seatunnel-pipeline">Seatunnel Pipeline<a class="hash-link" href="#seatunnel-pipeline" title="Direct link to heading">â€‹</a></h3><p>æˆ‘ä»¬ä»…éœ€è¦ç¼–å†™ä¸€ä¸ªSeatunnel Pipelineçš„é…ç½®æ–‡ä»¶å³å¯å®Œæˆæ•°æ®çš„å¯¼å…¥ã€‚</p><p>é…ç½®æ–‡ä»¶åŒ…æ‹¬å››ä¸ªéƒ¨åˆ†ï¼Œåˆ†åˆ«æ˜¯Sparkã€Inputã€filterå’ŒOutputã€‚</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="spark">Spark<a class="hash-link" href="#spark" title="Direct link to heading">â€‹</a></h4><p>è¿™ä¸€éƒ¨åˆ†æ˜¯Sparkçš„ç›¸å…³é…ç½®ï¼Œä¸»è¦é…ç½®Sparkæ‰§è¡Œæ—¶æ‰€éœ€çš„èµ„æºå¤§å°ã€‚</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">spark {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  // è¿™ä¸ªé…ç½®å¿…éœ€å¡«å†™</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.sql.catalogImplementation = &quot;hive&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.app.name = &quot;seatunnel&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.executor.instances = 2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.executor.cores = 1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.executor.memory = &quot;1g&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="input">Input<a class="hash-link" href="#input" title="Direct link to heading">â€‹</a></h4><p>è¿™ä¸€éƒ¨åˆ†å®šä¹‰æ•°æ®æºï¼Œå¦‚ä¸‹æ˜¯ä»Hiveæ–‡ä»¶ä¸­è¯»å–textæ ¼å¼æ•°æ®çš„é…ç½®æ¡ˆä¾‹ã€‚</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">input {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    hive {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        pre_sql = &quot;select * from access.nginx_msg_detail&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        table_name = &quot;access_log&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>çœ‹ï¼Œå¾ˆç®€å•çš„ä¸€ä¸ªé…ç½®å°±å¯ä»¥ä»Hiveä¸­è¯»å–æ•°æ®äº†ã€‚å…¶ä¸­<code>pre_sql</code>æ˜¯ä»Hiveä¸­è¯»å–æ•°æ®SQLï¼Œ<code>table_name</code>æ˜¯å°†è¯»å–åçš„æ•°æ®ï¼Œæ³¨å†Œæˆä¸ºSparkä¸­ä¸´æ—¶è¡¨çš„è¡¨åï¼Œå¯ä¸ºä»»æ„å­—æ®µã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¿…é¡»ä¿è¯hiveçš„metastoreæ˜¯åœ¨æœåŠ¡çŠ¶æ€ã€‚</p><p>åœ¨Clusterã€Clientã€Localæ¨¡å¼ä¸‹è¿è¡Œæ—¶ï¼Œå¿…é¡»æŠŠ<code>hive-site.xml</code>æ–‡ä»¶ç½®äºæäº¤ä»»åŠ¡èŠ‚ç‚¹çš„$HADOOP_CONFç›®å½•ä¸‹</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="filter">Filter<a class="hash-link" href="#filter" title="Direct link to heading">â€‹</a></h4><p>åœ¨Filteréƒ¨åˆ†ï¼Œè¿™é‡Œæˆ‘ä»¬é…ç½®ä¸€ç³»åˆ—çš„è½¬åŒ–ï¼Œæˆ‘ä»¬è¿™é‡ŒæŠŠä¸éœ€è¦çš„minuteå’Œhourå­—æ®µä¸¢å¼ƒã€‚å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨è¯»å–Hiveçš„æ—¶å€™é€šè¿‡<code>pre_sql</code>ä¸è¯»å–è¿™äº›å­—æ®µ</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">filter {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    remove {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        source_field = [&quot;minute&quot;, &quot;hour&quot;]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="output">Output<a class="hash-link" href="#output" title="Direct link to heading">â€‹</a></h4><p>æœ€åæˆ‘ä»¬å°†å¤„ç†å¥½çš„ç»“æ„åŒ–æ•°æ®å†™å…¥ClickHouse</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">output {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    clickhouse {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        host = &quot;your.clickhouse.host:8123&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        database = &quot;seatunnel&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        table = &quot;nginx_log&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        fields = [&quot;date&quot;, &quot;datetime&quot;, &quot;hostname&quot;, &quot;url&quot;, &quot;http_code&quot;, &quot;request_time&quot;, &quot;data_size&quot;, &quot;domain&quot;]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        username = &quot;username&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        password = &quot;password&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="running-seatunnel">Running Seatunnel<a class="hash-link" href="#running-seatunnel" title="Direct link to heading">â€‹</a></h3><p>æˆ‘ä»¬å°†ä¸Šè¿°å››éƒ¨åˆ†é…ç½®ç»„åˆæˆä¸ºæˆ‘ä»¬çš„é…ç½®æ–‡ä»¶<code>config/batch.conf</code>ã€‚</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">vim config/batch.conf</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">spark {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.app.name = &quot;seatunnel&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.executor.instances = 2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.executor.cores = 1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.executor.memory = &quot;1g&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  // è¿™ä¸ªé…ç½®å¿…éœ€å¡«å†™</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.sql.catalogImplementation = &quot;hive&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">input {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    hive {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        pre_sql = &quot;select * from access.nginx_msg_detail&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        table_name = &quot;access_log&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">filter {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    remove {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        source_field = [&quot;minute&quot;, &quot;hour&quot;]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">output {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    clickhouse {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        host = &quot;your.clickhouse.host:8123&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        database = &quot;seatunnel&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        table = &quot;access_log&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        fields = [&quot;date&quot;, &quot;datetime&quot;, &quot;hostname&quot;, &quot;uri&quot;, &quot;http_code&quot;, &quot;request_time&quot;, &quot;data_size&quot;, &quot;domain&quot;]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        username = &quot;username&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        password = &quot;password&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>æ‰§è¡Œå‘½ä»¤ï¼ŒæŒ‡å®šé…ç½®æ–‡ä»¶ï¼Œè¿è¡Œ Seatunnelï¼Œå³å¯å°†æ•°æ®å†™å…¥ClickHouseã€‚è¿™é‡Œæˆ‘ä»¬ä»¥æœ¬åœ°æ¨¡å¼ä¸ºä¾‹ã€‚</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">./bin/start-seatunnel.sh --config config/batch.conf -e client -m &#x27;local[2]&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="conclusion">Conclusion<a class="hash-link" href="#conclusion" title="Direct link to heading">â€‹</a></h2><p>åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨ Seatunnel å°†Hiveä¸­çš„æ•°æ®å¯¼å…¥ClickHouseä¸­ã€‚ä»…ä»…é€šè¿‡ä¸€ä¸ªé…ç½®æ–‡ä»¶ä¾¿å¯å¿«é€Ÿå®Œæˆæ•°æ®çš„å¯¼å…¥ï¼Œæ— éœ€ç¼–å†™ä»»ä½•ä»£ç ï¼Œååˆ†ç®€å•ã€‚</p><p>å¸Œæœ›äº†è§£ Seatunnel ä¸ClickHouseã€Elasticsearchã€Kafkaã€Hadoopç»“åˆä½¿ç”¨çš„æ›´å¤šåŠŸèƒ½å’Œæ¡ˆä¾‹ï¼Œå¯ä»¥ç›´æ¥è¿›å…¥å®˜ç½‘ <a href="https://seatunnel.apache.org/" target="_blank" rel="noopener noreferrer">https://seatunnel.apache.org/</a></p><p>-- Power by <a href="https://github.com/InterestingLab" target="_blank" rel="noopener noreferrer">InterestingLab</a></p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/zh-CN/blog/tags/hive">Hive</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/zh-CN/blog/tags/click-house">ClickHouse</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_rzP5" itemprop="headline"><a itemprop="url" href="/zh-CN/blog/spark-execute-elasticsearch">å¦‚ä½•ä½¿ç”¨ Spark å¿«é€Ÿå°†æ•°æ®å†™å…¥ Elasticsearch</a></h2><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2021-12-30T00:00:00.000Z" itemprop="datePublished">2021å¹´12æœˆ30æ—¥</time> Â· <!-- -->One min read</div></header><div class="markdown" itemprop="articleBody"><p>è¯´åˆ°æ•°æ®å†™å…¥ Elasticsearchï¼Œæœ€å…ˆæƒ³åˆ°çš„è‚¯å®šæ˜¯Logstashã€‚Logstashå› ä¸ºå…¶ç®€å•ä¸Šæ‰‹ã€å¯æ‰©å±•ã€å¯ä¼¸ç¼©ç­‰ä¼˜ç‚¹è¢«å¹¿å¤§ç”¨æˆ·æ¥å—ã€‚ä½†æ˜¯å°ºæœ‰æ‰€çŸ­ï¼Œå¯¸æœ‰æ‰€é•¿ï¼ŒLogstashè‚¯å®šä¹Ÿæœ‰å®ƒæ— æ³•é€‚ç”¨çš„åº”ç”¨åœºæ™¯ï¼Œæ¯”å¦‚ï¼š</p><ul><li>æµ·é‡æ•°æ®ETL</li><li>æµ·é‡æ•°æ®èšåˆ</li><li>å¤šæºæ•°æ®å¤„ç†</li></ul><p>ä¸ºäº†æ»¡è¶³è¿™äº›åœºæ™¯ï¼Œå¾ˆå¤šåŒå­¦éƒ½ä¼šé€‰æ‹©Sparkï¼Œå€ŸåŠ©Sparkç®—å­è¿›è¡Œæ•°æ®å¤„ç†ï¼Œæœ€åå°†å¤„ç†ç»“æœå†™å…¥Elasticsearchã€‚</p><p>æˆ‘ä»¬éƒ¨é—¨ä¹‹å‰åˆ©ç”¨Sparkå¯¹Nginxæ—¥å¿—è¿›è¡Œåˆ†æï¼Œç»Ÿè®¡æˆ‘ä»¬çš„WebæœåŠ¡è®¿é—®æƒ…å†µï¼Œå°†Nginxæ—¥å¿—æ¯åˆ†é’Ÿèšåˆä¸€æ¬¡æœ€åå°†ç»“æœå†™å…¥Elasticsearchï¼Œç„¶ååˆ©ç”¨Kibanaé…ç½®å®æ—¶ç›‘æ§Dashboardã€‚Elasticsearchå’ŒKibanaéƒ½å¾ˆæ–¹ä¾¿ã€å®ç”¨ï¼Œä½†æ˜¯éšç€ç±»ä¼¼éœ€æ±‚è¶Šæ¥è¶Šå¤šï¼Œå¦‚ä½•å¿«é€Ÿé€šè¿‡Sparkå°†æ•°æ®å†™å…¥Elasticsearchæˆä¸ºäº†æˆ‘ä»¬çš„ä¸€å¤§é—®é¢˜ã€‚</p><p>ä»Šå¤©ç»™å¤§å®¶æ¨èä¸€æ¬¾èƒ½å¤Ÿå®ç°æ•°æ®å¿«é€Ÿå†™å…¥çš„é»‘ç§‘æŠ€ Seatunnel <a href="https://github.com/apache/incubator-seatunnel" target="_blank" rel="noopener noreferrer">https://github.com/apache/incubator-seatunnel</a> ä¸€ä¸ªéå¸¸æ˜“ç”¨ï¼Œé«˜æ€§èƒ½ï¼Œèƒ½å¤Ÿåº”å¯¹æµ·é‡æ•°æ®çš„å®æ—¶æ•°æ®å¤„ç†äº§å“ï¼Œå®ƒæ„å»ºåœ¨Sparkä¹‹ä¸Šï¼Œç®€å•æ˜“ç”¨ï¼Œçµæ´»é…ç½®ï¼Œæ— éœ€å¼€å‘ã€‚</p><p><img loading="lazy" src="/zh-CN/assets/images/wd-struct-fd963482dc80fdee6e4930107709bd28.png" width="818" height="466"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="kafka-to-elasticsearch">Kafka to Elasticsearch<a class="hash-link" href="#kafka-to-elasticsearch" title="Direct link to heading">â€‹</a></h2><p>å’ŒLogstashä¸€æ ·ï¼ŒSeatunnelåŒæ ·æ”¯æŒå¤šç§ç±»å‹çš„æ•°æ®è¾“å…¥ï¼Œè¿™é‡Œæˆ‘ä»¬ä»¥æœ€å¸¸è§çš„Kakfaä½œä¸ºè¾“å…¥æºä¸ºä¾‹ï¼Œè®²è§£å¦‚ä½•ä½¿ç”¨ Seatunnel å°†æ•°æ®å¿«é€Ÿå†™å…¥Elasticsearch</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="log-sample">Log Sample<a class="hash-link" href="#log-sample" title="Direct link to heading">â€‹</a></h3><p>åŸå§‹æ—¥å¿—æ ¼å¼å¦‚ä¸‹:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1 elasticsearch.cn 114.250.140.241 0.001s &quot;127.0.0.1:80&quot; [26/Oct/2018:21:54:32 +0800] &quot;GET /article HTTP/1.1&quot; 200 123 &quot;-&quot; - &quot;Dalvik/2.1.0 (Linux; U; Android 7.1.1; OPPO R11 Build/NMF26X)&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="elasticsearch-document">Elasticsearch Document<a class="hash-link" href="#elasticsearch-document" title="Direct link to heading">â€‹</a></h3><p>æˆ‘ä»¬æƒ³è¦ç»Ÿè®¡ï¼Œä¸€åˆ†é’Ÿæ¯ä¸ªåŸŸåçš„è®¿é—®æƒ…å†µï¼Œèšåˆå®Œçš„æ•°æ®æœ‰ä»¥ä¸‹å­—æ®µ:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">domain String</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hostname String</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">status int</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">datetime String</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">count int</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="seatunnel-with-elasticsearch">Seatunnel with Elasticsearch<a class="hash-link" href="#seatunnel-with-elasticsearch" title="Direct link to heading">â€‹</a></h2><p>æ¥ä¸‹æ¥ä¼šç»™å¤§å®¶è¯¦ç»†ä»‹ç»ï¼Œæˆ‘ä»¬å¦‚ä½•é€šè¿‡ Seatunnel è¯»å–Kafkaä¸­çš„æ•°æ®ï¼Œå¯¹æ•°æ®è¿›è¡Œè§£æä»¥åŠèšåˆï¼Œæœ€åå°†å¤„ç†ç»“æœå†™å…¥Elasticsearchä¸­ã€‚</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="seatunnel">Seatunnel<a class="hash-link" href="#seatunnel" title="Direct link to heading">â€‹</a></h3><p><a href="https://github.com/apache/incubator-seatunnel" target="_blank" rel="noopener noreferrer">Seatunnel</a> åŒæ ·æ‹¥æœ‰ç€éå¸¸ä¸°å¯Œçš„æ’ä»¶ï¼Œæ”¯æŒä»Kafkaã€HDFSã€Hiveä¸­è¯»å–æ•°æ®ï¼Œè¿›è¡Œå„ç§å„æ ·çš„æ•°æ®å¤„ç†ï¼Œå¹¶å°†ç»“æœå†™å…¥Elasticsearchã€Kuduæˆ–è€…Kafkaä¸­ã€‚</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="prerequisites">Prerequisites<a class="hash-link" href="#prerequisites" title="Direct link to heading">â€‹</a></h3><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦å®‰è£…seatunnelï¼Œå®‰è£…ååˆ†ç®€å•ï¼Œæ— éœ€é…ç½®ç³»ç»Ÿç¯å¢ƒå˜é‡</p><ol><li>å‡†å¤‡Sparkç¯å¢ƒ</li><li>å®‰è£… Seatunnel</li><li>é…ç½® Seatunnel</li></ol><p>ä»¥ä¸‹æ˜¯ç®€æ˜“æ­¥éª¤ï¼Œå…·ä½“å®‰è£…å¯ä»¥å‚ç…§ <a href="/zh-CN/docs/quick-start">Quick Start</a></p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cd /usr/local</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">wget https</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">//archive.apache.org/dist/spark/spark</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">2.2.0/spark</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">2.2.0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">bin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">hadoop2.7.tgz</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">tar </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">xvf https</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">//archive.apache.org/dist/spark/spark</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">2.2.0/spark</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">2.2.0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">bin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">hadoop2.7.tgz</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">wget https</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">//github.com/InterestingLab/seatunnel/releases/download/v1.1.1/seatunnel</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">1.1.1.zip</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">unzip seatunnel</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">1.1.1.zip</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cd seatunnel</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">1.1.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vim config/seatunnel</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">env.sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># æŒ‡å®šSparkå®‰è£…è·¯å¾„</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SPARK_HOME=$</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">SPARK_HOME</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">/usr/local/spark</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">2.2.0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">bin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">hadoop2.7</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="seatunnel-pipeline">Seatunnel Pipeline<a class="hash-link" href="#seatunnel-pipeline" title="Direct link to heading">â€‹</a></h3><p>ä¸Logstashä¸€æ ·ï¼Œæˆ‘ä»¬ä»…éœ€è¦ç¼–å†™ä¸€ä¸ªSeatunnel Pipelineçš„é…ç½®æ–‡ä»¶å³å¯å®Œæˆæ•°æ®çš„å¯¼å…¥ï¼Œç›¸ä¿¡äº†è§£Logstashçš„æœ‹å‹å¯ä»¥å¾ˆå¿«å…¥æ‰‹ Seatunnel é…ç½®ã€‚</p><p>é…ç½®æ–‡ä»¶åŒ…æ‹¬å››ä¸ªéƒ¨åˆ†ï¼Œåˆ†åˆ«æ˜¯Sparkã€Inputã€filterå’ŒOutputã€‚</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="spark">Spark<a class="hash-link" href="#spark" title="Direct link to heading">â€‹</a></h4><p>è¿™ä¸€éƒ¨åˆ†æ˜¯Sparkçš„ç›¸å…³é…ç½®ï¼Œä¸»è¦é…ç½®Sparkæ‰§è¡Œæ—¶æ‰€éœ€çš„èµ„æºå¤§å°ã€‚</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">spark {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.app.name = &quot;seatunnel&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.executor.instances = 2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.executor.cores = 1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.executor.memory = &quot;1g&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.streaming.batchDuration = 5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="input">Input<a class="hash-link" href="#input" title="Direct link to heading">â€‹</a></h4><p>è¿™ä¸€éƒ¨åˆ†å®šä¹‰æ•°æ®æºï¼Œå¦‚ä¸‹æ˜¯ä»Kafkaä¸­è¯»å–æ•°æ®çš„é…ç½®æ¡ˆä¾‹ï¼Œ</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">kafkaStream {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    topics = &quot;seatunnel-es&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    consumer.bootstrap.servers = &quot;localhost:9092&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    consumer.group.id = &quot;seatunnel_es_group&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    consumer.rebalance.max.retries = 100</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="filter">Filter<a class="hash-link" href="#filter" title="Direct link to heading">â€‹</a></h4><p>åœ¨Filteréƒ¨åˆ†ï¼Œè¿™é‡Œæˆ‘ä»¬é…ç½®ä¸€ç³»åˆ—çš„è½¬åŒ–ï¼ŒåŒ…æ‹¬æ­£åˆ™è§£æå°†æ—¥å¿—è¿›è¡Œæ‹†åˆ†ã€æ—¶é—´è½¬æ¢å°†HTTPDATEè½¬åŒ–ä¸ºElasticsearchæ”¯æŒçš„æ—¥æœŸæ ¼å¼ã€å¯¹Numberç±»å‹çš„å­—æ®µè¿›è¡Œç±»å‹è½¬æ¢ä»¥åŠé€šè¿‡SQLè¿›è¡Œæ•°æ®èšåˆ</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">filter </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># ä½¿ç”¨æ­£åˆ™è§£æåŸå§‹æ—¥å¿—</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># æœ€å¼€å§‹æ•°æ®éƒ½åœ¨raw_messageå­—æ®µä¸­</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    grok </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        source_field = &quot;raw_message&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        pattern = &#x27;%</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">NOTSPACE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">hostname</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">\\s%</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">NOTSPACE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">domain</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">\\s%</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">IP</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">remote_addr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">\\s%</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">NUMBER</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">request_time</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">s\\s\&quot;%</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">DATA</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">upstream_ip</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">\&quot;\\s\\</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">%</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">HTTPDATE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">timestamp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">\\</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">\\s\&quot;%</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">NOTSPACE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">method</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">\\s%</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">DATA</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">url</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">\\s%</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">NOTSPACE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">http_ver</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">\&quot;\\s%</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">NUMBER</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">status</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">\\s%</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">NUMBER</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">body_bytes_send</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">\\s%</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">DATA</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">referer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">\\s%</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">NOTSPACE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">cookie_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">\\s\&quot;%</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">DATA</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">user_agent</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># å°†&quot;dd/MMM/yyyy:HH:mm:ss Z&quot;æ ¼å¼çš„æ•°æ®è½¬æ¢ä¸º</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Elasticsearchä¸­æ”¯æŒçš„æ ¼å¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    date </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        source_field = &quot;timestamp&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        target_field = &quot;datetime&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        source_time_format = &quot;dd/MMM/yyyy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">HH</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">mm</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">ss Z&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        target_time_format = &quot;yyyy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">MM</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">dd&#x27;T&#x27;HH</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">mm</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">ss.SSS+08</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">00&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">## åˆ©ç”¨SQLå¯¹æ•°æ®è¿›è¡Œèšåˆ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    sql </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        table_name = &quot;access_log&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        sql = &quot;select domain</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> hostname</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> int(status)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> datetime</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> count(</span><span class="token important">*)</span><span class="token plain"> from access_log group by domain</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> hostname</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> status</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> datetime&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="output">Output<a class="hash-link" href="#output" title="Direct link to heading">â€‹</a></h4><p>æœ€åæˆ‘ä»¬å°†å¤„ç†å¥½çš„ç»“æ„åŒ–æ•°æ®å†™å…¥Elasticsearchã€‚</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">output </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    elasticsearch </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        hosts = </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;localhost:9200&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        index = &quot;seatunnel</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">$</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">now</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        es.batch.size.entries = 100000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        index_time_format = &quot;yyyy.MM.dd&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="running-seatunnel">Running Seatunnel<a class="hash-link" href="#running-seatunnel" title="Direct link to heading">â€‹</a></h3><p>æˆ‘ä»¬å°†ä¸Šè¿°å››éƒ¨åˆ†é…ç½®ç»„åˆæˆä¸ºæˆ‘ä»¬çš„é…ç½®æ–‡ä»¶ <code>config/batch.conf</code>ã€‚</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">vim config/batch.conf</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">spark {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.app.name = &quot;seatunnel&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.executor.instances = 2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.executor.cores = 1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.executor.memory = &quot;1g&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.streaming.batchDuration = 5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">input {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    kafkaStream {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        topics = &quot;seatunnel-es&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        consumer.bootstrap.servers = &quot;localhost:9092&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        consumer.group.id = &quot;seatunnel_es_group&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        consumer.rebalance.max.retries = 100</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">filter {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    # ä½¿ç”¨æ­£åˆ™è§£æåŸå§‹æ—¥å¿—</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    # æœ€å¼€å§‹æ•°æ®éƒ½åœ¨raw_messageå­—æ®µä¸­</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    grok {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        source_field = &quot;raw_message&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        pattern = &#x27;%{IP:hostname}\\s%{NOTSPACE:domain}\\s%{IP:remote_addr}\\s%{NUMBER:request_time}s\\s\&quot;%{DATA:upstream_ip}\&quot;\\s\\[%{HTTPDATE:timestamp}\\]\\s\&quot;%{NOTSPACE:method}\\s%{DATA:url}\\s%{NOTSPACE:http_ver}\&quot;\\s%{NUMBER:status}\\s%{NUMBER:body_bytes_send}\\s%{DATA:referer}\\s%{NOTSPACE:cookie_info}\\s\&quot;%{DATA:user_agent}&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    # å°†&quot;dd/MMM/yyyy:HH:mm:ss Z&quot;æ ¼å¼çš„æ•°æ®è½¬æ¢ä¸º</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    # Elasticsearchä¸­æ”¯æŒçš„æ ¼å¼</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    date {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        source_field = &quot;timestamp&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        target_field = &quot;datetime&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        source_time_format = &quot;dd/MMM/yyyy:HH:mm:ss Z&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        target_time_format = &quot;yyyy-MM-dd&#x27;T&#x27;HH:mm:00.SSS+08:00&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ## åˆ©ç”¨SQLå¯¹æ•°æ®è¿›è¡Œèšåˆ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    sql {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        table_name = &quot;access_log&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        sql = &quot;select domain, hostname, status, datetime, count(*) from access_log group by domain, hostname, status, datetime&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">output {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    elasticsearch {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        hosts = [&quot;localhost:9200&quot;]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        index = &quot;seatunnel-${now}&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        es.batch.size.entries = 100000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        index_time_format = &quot;yyyy.MM.dd&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>æ‰§è¡Œå‘½ä»¤ï¼ŒæŒ‡å®šé…ç½®æ–‡ä»¶ï¼Œè¿è¡Œ Seatunnelï¼Œå³å¯å°†æ•°æ®å†™å…¥Elasticsearchã€‚è¿™é‡Œæˆ‘ä»¬ä»¥æœ¬åœ°æ¨¡å¼ä¸ºä¾‹ã€‚</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">./bin/start-seatunnel.sh --config config/batch.conf -e client -m &#x27;local[2]&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>æœ€åï¼Œå†™å…¥Elasticsearchä¸­çš„æ•°æ®å¦‚ä¸‹ï¼Œå†é…ä¸ŠKibanaå°±å¯ä»¥å®ç°WebæœåŠ¡çš„å®æ—¶ç›‘æ§äº†^_^.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">&quot;_source&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;domain&quot;: &quot;elasticsearch.cn&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;hostname&quot;: &quot;localhost&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;status&quot;: &quot;200&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;datetime&quot;: &quot;2018-11-26T21:54:00.000+08:00&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;count&quot;: 26</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="conclusion">Conclusion<a class="hash-link" href="#conclusion" title="Direct link to heading">â€‹</a></h2><p>åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†å¦‚ä½•é€šè¿‡ Seatunnel å°†Kafkaä¸­çš„æ•°æ®å†™å…¥Elasticsearchä¸­ã€‚ä»…ä»…é€šè¿‡ä¸€ä¸ªé…ç½®æ–‡ä»¶ä¾¿å¯å¿«é€Ÿè¿è¡Œä¸€ä¸ªSpark Applicationï¼Œå®Œæˆæ•°æ®çš„å¤„ç†ã€å†™å…¥ï¼Œæ— éœ€ç¼–å†™ä»»ä½•ä»£ç ï¼Œååˆ†ç®€å•ã€‚</p><p>å½“æ•°æ®å¤„ç†è¿‡ç¨‹ä¸­æœ‰é‡åˆ°Logstashæ— æ³•æ”¯æŒçš„åœºæ™¯æˆ–è€…Logstahæ€§èƒ½æ— æ³•è¾¾åˆ°é¢„æœŸçš„æƒ…å†µä¸‹ï¼Œéƒ½å¯ä»¥å°è¯•ä½¿ç”¨ Seatunnel è§£å†³é—®é¢˜ã€‚</p><p>å¸Œæœ›äº†è§£ Seatunnel ä¸Elasticsearchã€Kafkaã€Hadoopç»“åˆä½¿ç”¨çš„æ›´å¤šåŠŸèƒ½å’Œæ¡ˆä¾‹ï¼Œå¯ä»¥ç›´æ¥è¿›å…¥å®˜ç½‘ <a href="https://seatunnel.apache.org/" target="_blank" rel="noopener noreferrer">https://seatunnel.apache.org/</a></p><p><strong>æˆ‘ä»¬è¿‘æœŸä¼šå†å‘å¸ƒä¸€ç¯‡ã€Šå¦‚ä½•ç”¨Sparkå’ŒElasticsearchåšäº¤äº’å¼æ•°æ®åˆ†æã€‹ï¼Œæ•¬è¯·æœŸå¾….</strong></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="contract-us">Contract us<a class="hash-link" href="#contract-us" title="Direct link to heading">â€‹</a></h2><ul><li>é‚®ä»¶åˆ—è¡¨ : <strong><a href="mailto:dev@seatunnel.apache.org" target="_blank" rel="noopener noreferrer">dev@seatunnel.apache.org</a></strong>. å‘é€ä»»æ„å†…å®¹è‡³ <code>dev-subscribe@seatunnel.apache.org</code>ï¼Œ æŒ‰ç…§å›å¤è®¢é˜…é‚®ä»¶åˆ—è¡¨ã€‚</li><li>Slack: å‘é€ <code>Request to join SeaTunnel slack</code> é‚®ä»¶åˆ°é‚®ä»¶åˆ—è¡¨ (<code>dev@seatunnel.apache.org</code>), æˆ‘ä»¬ä¼šé‚€è¯·ä½ åŠ å…¥ï¼ˆåœ¨æ­¤ä¹‹å‰è¯·ç¡®è®¤å·²ç»æ³¨å†ŒSlackï¼‰.</li><li><a href="https://space.bilibili.com/1542095008" target="_blank" rel="noopener noreferrer">bilibili Bç«™ è§†é¢‘</a></li></ul></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/zh-CN/blog/tags/spark">Spark</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/zh-CN/blog/tags/kafka">Kafka</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/zh-CN/blog/tags/elasticsearch">Elasticsearch</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_rzP5" itemprop="headline"><a itemprop="url" href="/zh-CN/blog/spark-execute-tidb">æ€ä¹ˆç”¨ Spark åœ¨ TiDB ä¸Šåš OLAP åˆ†æ</a></h2><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2021-12-30T00:00:00.000Z" itemprop="datePublished">2021å¹´12æœˆ30æ—¥</time> Â· <!-- -->One min read</div></header><div class="markdown" itemprop="articleBody"><p><img src="https://download.pingcap.com/images/tidb-planet.jpg"></p><p><a href="https://github.com/pingcap/tidb" target="_blank" rel="noopener noreferrer">TiDB</a> æ˜¯ä¸€æ¬¾å®šä½äºåœ¨çº¿äº‹åŠ¡å¤„ç†/åœ¨çº¿åˆ†æå¤„ç†çš„èåˆå‹æ•°æ®åº“äº§å“ï¼Œå®ç°äº†ä¸€é”®æ°´å¹³ä¼¸ç¼©ï¼Œå¼ºä¸€è‡´æ€§çš„å¤šå‰¯æœ¬æ•°æ®å®‰å…¨ï¼Œåˆ†å¸ƒå¼äº‹åŠ¡ï¼Œå®æ—¶ OLAP ç­‰é‡è¦ç‰¹æ€§ã€‚</p><p>TiSpark æ˜¯ PingCAP ä¸ºè§£å†³ç”¨æˆ·å¤æ‚ OLAP éœ€æ±‚è€Œæ¨å‡ºçš„äº§å“ã€‚å®ƒå€ŸåŠ© Spark å¹³å°ï¼ŒåŒæ—¶èåˆ TiKV åˆ†å¸ƒå¼é›†ç¾¤çš„ä¼˜åŠ¿ã€‚</p><p>ç›´æ¥ä½¿ç”¨ TiSpark å®Œæˆ OLAP æ“ä½œéœ€è¦äº†è§£ Sparkï¼Œè¿˜éœ€è¦ä¸€äº›å¼€å‘å·¥ä½œã€‚é‚£ä¹ˆï¼Œæœ‰æ²¡æœ‰ä¸€äº›å¼€ç®±å³ç”¨çš„å·¥å…·èƒ½å¸®æˆ‘ä»¬æ›´å¿«é€Ÿåœ°ä½¿ç”¨ TiSpark åœ¨ TiDB ä¸Šå®Œæˆ OLAP åˆ†æå‘¢ï¼Ÿ</p><p>ç›®å‰å¼€æºç¤¾åŒºä¸Šæœ‰ä¸€æ¬¾å·¥å…· <strong>Seatunnel</strong>ï¼Œé¡¹ç›®åœ°å€ <a href="https://github.com/apache/incubator-seatunnel" target="_blank" rel="noopener noreferrer">https://github.com/apache/incubator-seatunnel</a> ï¼Œå¯ä»¥åŸºäºSparkï¼Œåœ¨ TiSpark çš„åŸºç¡€ä¸Šå¿«é€Ÿå®ç° TiDB æ•°æ®è¯»å–å’Œ OLAP åˆ†æã€‚</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="ä½¿ç”¨-seatunnel-æ“ä½œtidb">ä½¿ç”¨ Seatunnel æ“ä½œTiDB<a class="hash-link" href="#ä½¿ç”¨-seatunnel-æ“ä½œtidb" title="Direct link to heading">â€‹</a></h2><p>åœ¨æˆ‘ä»¬çº¿ä¸Šæœ‰è¿™ä¹ˆä¸€ä¸ªéœ€æ±‚ï¼Œä» TiDB ä¸­è¯»å–æŸä¸€å¤©çš„ç½‘ç«™è®¿é—®æ•°æ®ï¼Œç»Ÿè®¡æ¯ä¸ªåŸŸåä»¥åŠæœåŠ¡è¿”å›çŠ¶æ€ç çš„è®¿é—®æ¬¡æ•°ï¼Œæœ€åå°†ç»Ÿè®¡ç»“æœå†™å…¥ TiDB å¦å¤–ä¸€ä¸ªè¡¨ä¸­ã€‚ æˆ‘ä»¬æ¥çœ‹çœ‹ Seatunnel æ˜¯å¦‚ä½•å®ç°è¿™ä¹ˆä¸€ä¸ªåŠŸèƒ½çš„ã€‚</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="seatunnel">Seatunnel<a class="hash-link" href="#seatunnel" title="Direct link to heading">â€‹</a></h3><p><a href="https://github.com/apache/incubator-seatunnel" target="_blank" rel="noopener noreferrer">Seatunnel</a> æ˜¯ä¸€ä¸ªéå¸¸æ˜“ç”¨ï¼Œé«˜æ€§èƒ½ï¼Œèƒ½å¤Ÿåº”å¯¹æµ·é‡æ•°æ®çš„å®æ—¶æ•°æ®å¤„ç†äº§å“ï¼Œå®ƒæ„å»ºåœ¨ Spark ä¹‹ä¸Šã€‚Seatunnel æ‹¥æœ‰ç€éå¸¸ä¸°å¯Œçš„æ’ä»¶ï¼Œæ”¯æŒä» TiDBã€Kafkaã€HDFSã€Kudu ä¸­è¯»å–æ•°æ®ï¼Œè¿›è¡Œå„ç§å„æ ·çš„æ•°æ®å¤„ç†ï¼Œç„¶åå°†ç»“æœå†™å…¥ TiDBã€ClickHouseã€Elasticsearch æˆ–è€… Kafka ä¸­ã€‚</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="å‡†å¤‡å·¥ä½œ">å‡†å¤‡å·¥ä½œ<a class="hash-link" href="#å‡†å¤‡å·¥ä½œ" title="Direct link to heading">â€‹</a></h4><h5 class="anchor anchorWithStickyNavbar_mojV" id="1-tidb-è¡¨ç»“æ„ä»‹ç»">1. TiDB è¡¨ç»“æ„ä»‹ç»<a class="hash-link" href="#1-tidb-è¡¨ç»“æ„ä»‹ç»" title="Direct link to heading">â€‹</a></h5><p><strong>Input</strong>ï¼ˆå­˜å‚¨è®¿é—®æ—¥å¿—çš„è¡¨ï¼‰</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">CREATE TABLE access_log (</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    domain VARCHAR(255),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    datetime VARCHAR(63),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    remote_addr VARCHAR(63),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    http_ver VARCHAR(15),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    body_bytes_send INT,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    status INT,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    request_time FLOAT,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    url TEXT</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">+-----------------+--------------+------+------+---------+-------+</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Field           | Type         | Null | Key  | Default | Extra |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+-----------------+--------------+------+------+---------+-------+</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| domain          | varchar(255) | YES  |      | NULL    |       |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| datetime        | varchar(63)  | YES  |      | NULL    |       |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| remote_addr     | varchar(63)  | YES  |      | NULL    |       |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| http_ver        | varchar(15)  | YES  |      | NULL    |       |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| body_bytes_send | int(11)      | YES  |      | NULL    |       |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| status          | int(11)      | YES  |      | NULL    |       |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| request_time    | float        | YES  |      | NULL    |       |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| url             | text         | YES  |      | NULL    |       |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+-----------------+--------------+------+------+---------+-------+</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p><strong>Output</strong>ï¼ˆå­˜å‚¨ç»“æœæ•°æ®çš„è¡¨ï¼‰</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">CREATE TABLE access_collect (</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    date VARCHAR(23),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    domain VARCHAR(63),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    status INT,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    hit INT</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">+--------+-------------+------+------+---------+-------+</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Field  | Type        | Null | Key  | Default | Extra |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+--------+-------------+------+------+---------+-------+</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| date   | varchar(23) | YES  |      | NULL    |       |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| domain | varchar(63) | YES  |      | NULL    |       |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| status | int(11)     | YES  |      | NULL    |       |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| hit    | int(11)     | YES  |      | NULL    |       |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+--------+-------------+------+------+---------+-------+</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h5 class="anchor anchorWithStickyNavbar_mojV" id="2-å®‰è£…-seatunnel">2. å®‰è£… Seatunnel<a class="hash-link" href="#2-å®‰è£…-seatunnel" title="Direct link to heading">â€‹</a></h5><p>æœ‰äº† TiDB è¾“å…¥å’Œè¾“å‡ºè¡¨ä¹‹åï¼Œ æˆ‘ä»¬éœ€è¦å®‰è£… Seatunnelï¼Œå®‰è£…ååˆ†ç®€å•ï¼Œæ— éœ€é…ç½®ç³»ç»Ÿç¯å¢ƒå˜é‡</p><ol><li>å‡†å¤‡ Sparkç¯å¢ƒ</li><li>å®‰è£… Seatunnel</li><li>é…ç½® Seatunnel</li></ol><p>ä»¥ä¸‹æ˜¯ç®€æ˜“æ­¥éª¤ï¼Œå…·ä½“å®‰è£…å¯ä»¥å‚ç…§ <a href="/zh-CN/docs/quick-start">Quick Start</a></p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># ä¸‹è½½å®‰è£…Spark</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cd /usr/local</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">wget https://archive.apache.org/dist/spark/spark-2.1.0/spark-2.1.0-bin-hadoop2.7.tgz</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">tar -xvf https://archive.apache.org/dist/spark/spark-2.1.0/spark-2.1.0-bin-hadoop2.7.tgz</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">wget</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># ä¸‹è½½å®‰è£…seatunnel</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">https://github.com/InterestingLab/seatunnel/releases/download/v1.2.0/seatunnel-1.2.0.zip</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">unzip seatunnel-1.2.0.zip</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cd seatunnel-1.2.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vim config/seatunnel-env.sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># æŒ‡å®šSparkå®‰è£…è·¯å¾„</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SPARK_HOME=${SPARK_HOME:-/usr/local/spark-2.1.0-bin-hadoop2.7}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="å®ç°-seatunnel-å¤„ç†æµç¨‹">å®ç° Seatunnel å¤„ç†æµç¨‹<a class="hash-link" href="#å®ç°-seatunnel-å¤„ç†æµç¨‹" title="Direct link to heading">â€‹</a></h3><p>æˆ‘ä»¬ä»…éœ€è¦ç¼–å†™ä¸€ä¸ª Seatunnel é…ç½®æ–‡ä»¶å³å¯å®Œæˆæ•°æ®çš„è¯»å–ã€å¤„ç†ã€å†™å…¥ã€‚</p><p>Seatunnel é…ç½®æ–‡ä»¶ç”±å››ä¸ªéƒ¨åˆ†ç»„æˆï¼Œåˆ†åˆ«æ˜¯ <code>Spark</code>ã€<code>Input</code>ã€<code>Filter</code> å’Œ <code>Output</code>ã€‚<code>Input</code> éƒ¨åˆ†ç”¨äºæŒ‡å®šæ•°æ®çš„è¾“å…¥æºï¼Œ<code>Filter</code> éƒ¨åˆ†ç”¨äºå®šä¹‰å„ç§å„æ ·çš„æ•°æ®å¤„ç†ã€èšåˆï¼Œ<code>Output</code> éƒ¨åˆ†è´Ÿè´£å°†å¤„ç†ä¹‹åçš„æ•°æ®å†™å…¥æŒ‡å®šçš„æ•°æ®åº“æˆ–è€…æ¶ˆæ¯é˜Ÿåˆ—ã€‚</p><p>æ•´ä¸ªå¤„ç†æµç¨‹ä¸º <code>Input</code> -&gt; <code>Filter</code> -&gt; <code>Output</code>ï¼Œæ•´ä¸ªæµç¨‹ç»„æˆäº† Seatunnel çš„ å¤„ç†æµç¨‹ï¼ˆPipelineï¼‰ã€‚</p><blockquote><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªå…·ä½“é…ç½®ï¼Œæ­¤é…ç½®æ¥æºäºçº¿ä¸Šå®é™…åº”ç”¨ï¼Œä½†æ˜¯ä¸ºäº†æ¼”ç¤ºæœ‰æ‰€ç®€åŒ–ã€‚</p></blockquote><h5 class="anchor anchorWithStickyNavbar_mojV" id="input-tidb">Input (TiDB)<a class="hash-link" href="#input-tidb" title="Direct link to heading">â€‹</a></h5><p>è¿™é‡Œéƒ¨åˆ†é…ç½®å®šä¹‰è¾“å…¥æºï¼Œå¦‚ä¸‹æ˜¯ä» TiDB ä¸€å¼ è¡¨ä¸­è¯»å–æ•°æ®ã€‚</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">input {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    tidb {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        database = &quot;nginx&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        pre_sql = &quot;select * from nginx.access_log&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        table_name = &quot;spark_nginx_input&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h5 class="anchor anchorWithStickyNavbar_mojV" id="filter">Filter<a class="hash-link" href="#filter" title="Direct link to heading">â€‹</a></h5><p>åœ¨Filteréƒ¨åˆ†ï¼Œè¿™é‡Œæˆ‘ä»¬é…ç½®ä¸€ç³»åˆ—çš„è½¬åŒ–, å¤§éƒ¨åˆ†æ•°æ®åˆ†æçš„éœ€æ±‚ï¼Œéƒ½æ˜¯åœ¨Filterå®Œæˆçš„ã€‚Seatunnel æä¾›äº†ä¸°å¯Œçš„æ’ä»¶ï¼Œè¶³ä»¥æ»¡è¶³å„ç§æ•°æ®åˆ†æéœ€æ±‚ã€‚è¿™é‡Œæˆ‘ä»¬é€šè¿‡ SQL æ’ä»¶å®Œæˆæ•°æ®çš„èšåˆæ“ä½œã€‚</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">filter {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    sql {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        table_name = &quot;spark_nginx_log&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        sql = &quot;select count(*) as hit, domain, status, substring(datetime, 1, 10) as date from spark_nginx_log where substring(datetime, 1, 10)=&#x27;2019-01-20&#x27; group by domain, status, substring(datetime, 1, 10)&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h5 class="anchor anchorWithStickyNavbar_mojV" id="output-tidb">Output (TiDB)<a class="hash-link" href="#output-tidb" title="Direct link to heading">â€‹</a></h5><p>æœ€åï¼Œ æˆ‘ä»¬å°†å¤„ç†åçš„ç»“æœå†™å…¥TiDBå¦å¤–ä¸€å¼ è¡¨ä¸­ã€‚TiDB Outputæ˜¯é€šè¿‡JDBCå®ç°çš„</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">output {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    tidb {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        url = &quot;jdbc:mysql://127.0.0.1:4000/nginx?useUnicode=true&amp;characterEncoding=utf8&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        table = &quot;access_collect&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        user = &quot;username&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        password = &quot;password&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        save_mode = &quot;append&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h5 class="anchor anchorWithStickyNavbar_mojV" id="spark">Spark<a class="hash-link" href="#spark" title="Direct link to heading">â€‹</a></h5><p>è¿™ä¸€éƒ¨åˆ†æ˜¯ Spark çš„ç›¸å…³é…ç½®ï¼Œä¸»è¦é…ç½® Spark æ‰§è¡Œæ—¶æ‰€éœ€çš„èµ„æºå¤§å°ä»¥åŠå…¶ä»– Spark é…ç½®ã€‚</p><p>æˆ‘ä»¬çš„ TiDB Input æ’ä»¶æ˜¯åŸºäº TiSpark å®ç°çš„ï¼Œè€Œ TiSpark ä¾èµ–äº TiKV é›†ç¾¤å’Œ Placement Driver (PD)ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦æŒ‡å®š PD èŠ‚ç‚¹ä¿¡æ¯ä»¥åŠ TiSpark ç›¸å…³é…ç½®<code>spark.tispark.pd.addresses</code>å’Œ<code>spark.sql.extensions</code>ã€‚</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">spark {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.app.name = &quot;seatunnel-tidb&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.executor.instances = 2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.executor.cores = 1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.executor.memory = &quot;1g&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  # Set for TiSpark</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.tispark.pd.addresses = &quot;localhost:2379&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.sql.extensions = &quot;org.apache.spark.sql.TiExtensions&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="è¿è¡Œ-seatunnel">è¿è¡Œ Seatunnel<a class="hash-link" href="#è¿è¡Œ-seatunnel" title="Direct link to heading">â€‹</a></h4><p>æˆ‘ä»¬å°†ä¸Šè¿°å››éƒ¨åˆ†é…ç½®ç»„åˆæˆæˆ‘ä»¬æœ€ç»ˆçš„é…ç½®æ–‡ä»¶ <code>conf/tidb.conf</code></p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">spark {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    spark.app.name = &quot;seatunnel-tidb&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    spark.executor.instances = 2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    spark.executor.cores = 1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    spark.executor.memory = &quot;1g&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    # Set for TiSpark</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    spark.tispark.pd.addresses = &quot;localhost:2379&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    spark.sql.extensions = &quot;org.apache.spark.sql.TiExtensions&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">input {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    tidb {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        database = &quot;nginx&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        pre_sql = &quot;select * from nginx.access_log&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        table_name = &quot;spark_table&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">filter {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    sql {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        table_name = &quot;spark_nginx_log&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        sql = &quot;select count(*) as hit, domain, status, substring(datetime, 1, 10) as date from spark_nginx_log where substring(datetime, 1, 10)=&#x27;2019-01-20&#x27; group by domain, status, substring(datetime, 1, 10)&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">output {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    tidb {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        url = &quot;jdbc:mysql://127.0.0.1:4000/nginx?useUnicode=true&amp;characterEncoding=utf8&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        table = &quot;access_collect&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        user = &quot;username&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        password = &quot;password&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        save_mode = &quot;append&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>æ‰§è¡Œå‘½ä»¤ï¼ŒæŒ‡å®šé…ç½®æ–‡ä»¶ï¼Œè¿è¡Œ Seatunnel ï¼Œå³å¯å®ç°æˆ‘ä»¬çš„æ•°æ®å¤„ç†é€»è¾‘ã€‚</p><ul><li>Local</li></ul><blockquote><p>./bin/start-seatunnel.sh --config config/tidb.conf --deploy-mode client --master &#x27;local<!-- -->[2]<!-- -->&#x27;</p></blockquote><ul><li>yarn-client</li></ul><blockquote><p>./bin/start-seatunnel.sh --config config/tidb.conf --deploy-mode client --master yarn</p></blockquote><ul><li>yarn-cluster</li></ul><blockquote><p>./bin/start-seatunnel.sh --config config/tidb.conf --deploy-mode cluster -master yarn</p></blockquote><p>å¦‚æœæ˜¯æœ¬æœºæµ‹è¯•éªŒè¯é€»è¾‘ï¼Œç”¨æœ¬åœ°æ¨¡å¼ï¼ˆLocalï¼‰å°±å¯ä»¥äº†ï¼Œä¸€èˆ¬ç”Ÿäº§ç¯å¢ƒä¸‹ï¼Œéƒ½æ˜¯ä½¿ç”¨<code>yarn-client</code>æˆ–è€…<code>yarn-cluster</code>æ¨¡å¼ã€‚</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="æ£€æŸ¥ç»“æœ">æ£€æŸ¥ç»“æœ<a class="hash-link" href="#æ£€æŸ¥ç»“æœ" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysql&gt; select * from access_collect;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+------------+--------+--------+------+</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| date       | domain | status | hit  |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+------------+--------+--------+------+</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| 2019-01-20 | b.com  |    200 |   63 |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| 2019-01-20 | a.com  |    200 |   85 |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+------------+--------+--------+------+</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2 rows in set (0.21 sec)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="æ€»ç»“">æ€»ç»“<a class="hash-link" href="#æ€»ç»“" title="Direct link to heading">â€‹</a></h2><p>åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨ Seatunnel ä» TiDB ä¸­è¯»å–æ•°æ®ï¼Œåšç®€å•çš„æ•°æ®å¤„ç†ä¹‹åå†™å…¥ TiDB å¦å¤–ä¸€ä¸ªè¡¨ä¸­ã€‚ä»…é€šè¿‡ä¸€ä¸ªé…ç½®æ–‡ä»¶ä¾¿å¯å¿«é€Ÿå®Œæˆæ•°æ®çš„å¯¼å…¥ï¼Œæ— éœ€ç¼–å†™ä»»ä½•ä»£ç ã€‚</p><p>é™¤äº†æ”¯æŒ TiDB æ•°æ®æºä¹‹å¤–ï¼ŒSeatunnel åŒæ ·æ”¯æŒElasticsearch, Kafka, Kudu, ClickHouseç­‰æ•°æ®æºã€‚</p><p><strong>äºæ­¤åŒæ—¶ï¼Œæˆ‘ä»¬æ­£åœ¨ç ”å‘ä¸€ä¸ªé‡è¦åŠŸèƒ½ï¼Œå°±æ˜¯åœ¨ Seatunnel ä¸­ï¼Œåˆ©ç”¨ TiDB çš„äº‹åŠ¡ç‰¹æ€§ï¼Œå®ç°ä» Kafka åˆ° TiDB æµå¼æ•°æ®å¤„ç†ï¼Œå¹¶ä¸”æ”¯æŒç«¯ï¼ˆKafkaï¼‰åˆ°ç«¯ï¼ˆTiDBï¼‰çš„ Exactly-Once æ•°æ®ä¸€è‡´æ€§ã€‚</strong></p><p>å¸Œæœ›äº†è§£ Seatunnel å’Œ TiDBï¼ŒClickHouseã€Elasticsearchã€Kafkaç»“åˆä½¿ç”¨çš„æ›´å¤šåŠŸèƒ½å’Œæ¡ˆä¾‹ï¼Œå¯ä»¥ç›´æ¥è¿›å…¥å®˜ç½‘ <a href="https://seatunnel.apache.org/" target="_blank" rel="noopener noreferrer">https://seatunnel.apache.org/</a></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="è”ç³»æˆ‘ä»¬">è”ç³»æˆ‘ä»¬<a class="hash-link" href="#è”ç³»æˆ‘ä»¬" title="Direct link to heading">â€‹</a></h2><ul><li>é‚®ä»¶åˆ—è¡¨ : <strong><a href="mailto:dev@seatunnel.apache.org" target="_blank" rel="noopener noreferrer">dev@seatunnel.apache.org</a></strong>. å‘é€ä»»æ„å†…å®¹è‡³ <code>dev-subscribe@seatunnel.apache.org</code>ï¼Œ æŒ‰ç…§å›å¤è®¢é˜…é‚®ä»¶åˆ—è¡¨ã€‚</li><li>Slack: å‘é€ <code>Request to join SeaTunnel slack</code> é‚®ä»¶åˆ°é‚®ä»¶åˆ—è¡¨ (<code>dev@seatunnel.apache.org</code>), æˆ‘ä»¬ä¼šé‚€è¯·ä½ åŠ å…¥ï¼ˆåœ¨æ­¤ä¹‹å‰è¯·ç¡®è®¤å·²ç»æ³¨å†ŒSlackï¼‰.</li><li><a href="https://space.bilibili.com/1542095008" target="_blank" rel="noopener noreferrer">bilibili Bç«™ è§†é¢‘</a></li></ul><p>-- Power by <a href="https://github.com/InterestingLab" target="_blank" rel="noopener noreferrer">InterestingLab</a></p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/zh-CN/blog/tags/spark">Spark</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/zh-CN/blog/tags/ti-db">TiDB</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_rzP5" itemprop="headline"><a itemprop="url" href="/zh-CN/blog/spark-structured-streaming">å¦‚ä½•æ”¯æŒçš„ Spark StructuredStreaming</a></h2><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2021-12-30T00:00:00.000Z" itemprop="datePublished">2021å¹´12æœˆ30æ—¥</time> Â· <!-- -->One min read</div></header><div class="markdown" itemprop="articleBody"><h3 class="anchor anchorWithStickyNavbar_mojV" id="å‰è¨€">å‰è¨€<a class="hash-link" href="#å‰è¨€" title="Direct link to heading">â€‹</a></h3><p>StructuredStreamingæ˜¯Spark 2.0ä»¥åæ–°å¼€æ”¾çš„ä¸€ä¸ªæ¨¡å—ï¼Œç›¸æ¯”SparkStreamingï¼Œå®ƒæœ‰ä¸€äº›æ¯”è¾ƒçªå‡ºçš„ä¼˜ç‚¹ï¼š<br> <!-- -->â€ƒ<!-- -->â€ƒ<!-- -->ä¸€ã€å®ƒèƒ½åšåˆ°æ›´ä½çš„å»¶è¿Ÿ;<br>
<!-- -->â€ƒ<!-- -->â€ƒ<!-- -->äºŒã€å¯ä»¥åšå®æ—¶çš„èšåˆï¼Œä¾‹å¦‚å®æ—¶è®¡ç®—æ¯å¤©æ¯ä¸ªå•†å“çš„é”€å”®æ€»é¢ï¼›<br>
<!-- -->â€ƒ<!-- -->â€ƒ<!-- -->ä¸‰ã€å¯ä»¥åšæµä¸æµä¹‹é—´çš„å…³è”ï¼Œä¾‹å¦‚è®¡ç®—å¹¿å‘Šçš„ç‚¹å‡»ç‡ï¼Œéœ€è¦å°†å¹¿å‘Šçš„æ›å…‰è®°å½•å’Œç‚¹å‡»è®°å½•å…³è”ã€‚<br>
ä»¥ä¸Šå‡ ç‚¹å¦‚æœä½¿ç”¨SparkStreamingæ¥å®ç°å¯èƒ½ä¼šæ¯”è¾ƒéº»çƒ¦æˆ–è€…è¯´æ˜¯å¾ˆéš¾å®ç°ï¼Œä½†æ˜¯ä½¿ç”¨StructuredStreamingå®ç°èµ·æ¥ä¼šæ¯”è¾ƒè½»æ¾ã€‚</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="å¦‚ä½•ä½¿ç”¨structuredstreaming">å¦‚ä½•ä½¿ç”¨StructuredStreaming<a class="hash-link" href="#å¦‚ä½•ä½¿ç”¨structuredstreaming" title="Direct link to heading">â€‹</a></h3><p>å¯èƒ½ä½ æ²¡æœ‰è¯¦ç»†ç ”ç©¶è¿‡StructuredStreamingï¼Œä½†æ˜¯å‘ç°StructuredStreamingèƒ½å¾ˆå¥½çš„è§£å†³ä½ çš„éœ€æ±‚ï¼Œå¦‚ä½•å¿«é€Ÿåˆ©ç”¨StructuredStreamingæ¥è§£å†³ä½ çš„éœ€æ±‚ï¼Ÿç›®å‰ç¤¾åŒºæœ‰ä¸€æ¬¾å·¥å…· <strong>Seatunnel</strong>ï¼Œé¡¹ç›®åœ°å€ï¼š<a href="https://github.com/apache/incubator-seatunnel" target="_blank" rel="noopener noreferrer">https://github.com/apache/incubator-seatunnel</a> ,
å¯ä»¥é«˜æ•ˆä½æˆæœ¬çš„å¸®åŠ©ä½ åˆ©ç”¨StructuredStreamingæ¥å®Œæˆä½ çš„éœ€æ±‚ã€‚</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="seatunnel">Seatunnel<a class="hash-link" href="#seatunnel" title="Direct link to heading">â€‹</a></h3><p>Seatunnel æ˜¯ä¸€ä¸ªéå¸¸æ˜“ç”¨ï¼Œé«˜æ€§èƒ½ï¼Œèƒ½å¤Ÿåº”å¯¹æµ·é‡æ•°æ®çš„å®æ—¶æ•°æ®å¤„ç†äº§å“ï¼Œå®ƒæ„å»ºåœ¨Sparkä¹‹ä¸Šã€‚Seatunnel æ‹¥æœ‰ç€éå¸¸ä¸°å¯Œçš„æ’ä»¶ï¼Œæ”¯æŒä»Kafkaã€HDFSã€Kuduä¸­è¯»å–æ•°æ®ï¼Œè¿›è¡Œå„ç§å„æ ·çš„æ•°æ®å¤„ç†ï¼Œå¹¶å°†ç»“æœå†™å…¥ClickHouseã€Elasticsearchæˆ–è€…Kafkaä¸­</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="å‡†å¤‡å·¥ä½œ">å‡†å¤‡å·¥ä½œ<a class="hash-link" href="#å‡†å¤‡å·¥ä½œ" title="Direct link to heading">â€‹</a></h3><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦å®‰è£… Seatunnelï¼Œå®‰è£…ååˆ†ç®€å•ï¼Œæ— éœ€é…ç½®ç³»ç»Ÿç¯å¢ƒå˜é‡</p><ol><li>å‡†å¤‡Sparkç¯å¢ƒ</li><li>å®‰è£… Seatunnel</li><li>é…ç½® Seatunnel</li></ol><p>ä»¥ä¸‹æ˜¯ç®€æ˜“æ­¥éª¤ï¼Œå…·ä½“å®‰è£…å¯ä»¥å‚ç…§ <a href="/zh-CN/docs/quick-start">Quick Start</a></p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cd /usr/local</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">wget https://archive.apache.org/dist/spark/spark-2.2.0/spark-2.2.0-bin-hadoop2.7.tgz</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">tar -xvf https://archive.apache.org/dist/spark/spark-2.2.0/spark-2.2.0-bin-hadoop2.7.tgz</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">wget https://github.com/InterestingLab/seatunnel/releases/download/v1.3.0/seatunnel-1.3.0.zip</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">unzip seatunnel-1.3.0.zip</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cd seatunnel-1.3.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vim config/seatunnel-env.sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># æŒ‡å®šSparkå®‰è£…è·¯å¾„</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SPARK_HOME=${SPARK_HOME:-/usr/local/spark-2.2.0-bin-hadoop2.7}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="seatunnel-pipeline">Seatunnel Pipeline<a class="hash-link" href="#seatunnel-pipeline" title="Direct link to heading">â€‹</a></h3><p>æˆ‘ä»¬ä»…éœ€è¦ç¼–å†™ä¸€ä¸ª Seatunnel Pipelineçš„é…ç½®æ–‡ä»¶å³å¯å®Œæˆæ•°æ®çš„å¯¼å…¥ã€‚</p><p>é…ç½®æ–‡ä»¶åŒ…æ‹¬å››ä¸ªéƒ¨åˆ†ï¼Œåˆ†åˆ«æ˜¯Sparkã€Inputã€filterå’ŒOutputã€‚</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="spark">Spark<a class="hash-link" href="#spark" title="Direct link to heading">â€‹</a></h4><p>è¿™ä¸€éƒ¨åˆ†æ˜¯Sparkçš„ç›¸å…³é…ç½®ï¼Œä¸»è¦é…ç½®Sparkæ‰§è¡Œæ—¶æ‰€éœ€çš„èµ„æºå¤§å°ã€‚</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">spark {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.app.name = &quot;seatunnel&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.executor.instances = 2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.executor.cores = 1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.executor.memory = &quot;1g&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="input">Input<a class="hash-link" href="#input" title="Direct link to heading">â€‹</a></h4><p>ä¸‹é¢æ˜¯ä¸€ä¸ªä»kafkaè¯»å–æ•°æ®çš„ä¾‹å­</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">kafkaStream {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    topics = &quot;seatunnel&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    consumer.bootstrap.servers = &quot;localhost:9092&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    schema = &quot;{\&quot;name\&quot;:\&quot;string\&quot;,\&quot;age\&quot;:\&quot;integer\&quot;,\&quot;addrs\&quot;:{\&quot;country\&quot;:\&quot;string\&quot;,\&quot;city\&quot;:\&quot;string\&quot;}}&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>é€šè¿‡ä¸Šé¢çš„é…ç½®å°±å¯ä»¥è¯»å–kafkaé‡Œçš„æ•°æ®äº† ï¼Œtopicsæ˜¯è¦è®¢é˜…çš„kafkaçš„topicï¼ŒåŒæ—¶è®¢é˜…å¤šä¸ªtopicå¯ä»¥ä»¥é€—å·éš”å¼€ï¼Œconsumer.bootstrap.serverså°±æ˜¯Kafkaçš„æœåŠ¡å™¨åˆ—è¡¨ï¼Œschemaæ˜¯å¯é€‰é¡¹ï¼Œå› ä¸ºStructuredStreamingä»kafkaè¯»å–åˆ°çš„å€¼(å®˜æ–¹å›ºå®šå­—æ®µvalue)æ˜¯binaryç±»å‹çš„ï¼Œè¯¦è§<a href="http://spark.apache.org/docs/latest/structured-streaming-kafka-integration.html" target="_blank" rel="noopener noreferrer">http://spark.apache.org/docs/latest/structured-streaming-kafka-integration.html</a>
ä½†æ˜¯å¦‚æœä½ ç¡®å®šä½ kafkaé‡Œçš„æ•°æ®æ˜¯jsonå­—ç¬¦ä¸²çš„è¯ï¼Œä½ å¯ä»¥æŒ‡å®šschemaï¼Œinputæ’ä»¶å°†æŒ‰ç…§ä½ æŒ‡å®šçš„schemaè§£æ</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="filter">Filter<a class="hash-link" href="#filter" title="Direct link to heading">â€‹</a></h4><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„filterä¾‹å­</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">filter{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    sql{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        table_name = &quot;student&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        sql = &quot;select name,age from student&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p><code>table_name</code>æ˜¯æ³¨å†Œæˆçš„ä¸´æ—¶è¡¨åï¼Œä»¥ä¾¿äºåœ¨ä¸‹é¢çš„sqlä½¿ç”¨</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="output">Output<a class="hash-link" href="#output" title="Direct link to heading">â€‹</a></h4><p>å¤„ç†å¥½çš„æ•°æ®å¾€å¤–è¾“å‡ºï¼Œå‡è®¾æˆ‘ä»¬çš„è¾“å‡ºä¹Ÿæ˜¯kafka</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">output{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    kafka {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        topic = &quot;seatunnel&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        producer.bootstrap.servers = &quot;localhost:9092&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        streaming_output_mode = &quot;update&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        checkpointLocation = &quot;/your/path&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p><code>topic</code> æ˜¯ä½ è¦è¾“å‡ºçš„topicï¼Œ<code> producer.bootstrap.servers</code>æ˜¯kafkaé›†ç¾¤åˆ—è¡¨ï¼Œ<code>streaming_output_mode</code>æ˜¯StructuredStreamingçš„ä¸€ä¸ªè¾“å‡ºæ¨¡å¼å‚æ•°ï¼Œæœ‰ä¸‰ç§ç±»å‹<code>append|update|complete</code>ï¼Œå…·ä½“ä½¿ç”¨å‚è§æ–‡æ¡£<a href="http://spark.apache.org/docs/latest/structured-streaming-programming-guide.html#output-modes" target="_blank" rel="noopener noreferrer">http://spark.apache.org/docs/latest/structured-streaming-programming-guide.html#output-modes</a></p><p><code>checkpointLocation</code>æ˜¯StructuredStreamingçš„checkpointè·¯å¾„ï¼Œå¦‚æœé…ç½®äº†çš„è¯ï¼Œè¿™ä¸ªç›®å½•ä¼šå­˜å‚¨ç¨‹åºçš„è¿è¡Œä¿¡æ¯ï¼Œæ¯”å¦‚ç¨‹åºé€€å‡ºå†å¯åŠ¨çš„è¯ä¼šæ¥ç€ä¸Šæ¬¡çš„offsetè¿›è¡Œæ¶ˆè´¹ã€‚</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="åœºæ™¯åˆ†æ">åœºæ™¯åˆ†æ<a class="hash-link" href="#åœºæ™¯åˆ†æ" title="Direct link to heading">â€‹</a></h3><p>ä»¥ä¸Šå°±æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥ä»‹ç»çš„ç¨å¾®å¤æ‚ä¸€äº›çš„ä¸šåŠ¡åœºæ™¯</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="åœºæ™¯ä¸€å®æ—¶èšåˆåœºæ™¯">åœºæ™¯ä¸€ï¼šå®æ—¶èšåˆåœºæ™¯<a class="hash-link" href="#åœºæ™¯ä¸€å®æ—¶èšåˆåœºæ™¯" title="Direct link to heading">â€‹</a></h4><p>å‡è®¾ç°åœ¨æœ‰ä¸€ä¸ªå•†åŸï¼Œä¸Šé¢æœ‰10ç§å•†å“ï¼Œç°åœ¨éœ€è¦å®æ—¶æ±‚æ¯å¤©æ¯ç§å•†å“çš„é”€å”®é¢ï¼Œç”šè‡³æ˜¯æ±‚æ¯ç§å•†å“çš„è´­ä¹°äººæ•°ï¼ˆä¸è¦æ±‚ååˆ†ç²¾ç¡®ï¼‰ã€‚
è¿™ä¹ˆåšçš„å·¨å¤§çš„ä¼˜åŠ¿å°±æ˜¯æµ·é‡æ•°æ®å¯ä»¥åœ¨å®æ—¶å¤„ç†çš„æ—¶å€™ï¼Œå®Œæˆèšåˆï¼Œå†ä¹Ÿä¸éœ€è¦å…ˆå°†æ•°æ®å†™å…¥æ•°æ®ä»“åº“ï¼Œå†è·‘ç¦»çº¿çš„å®šæ—¶ä»»åŠ¡è¿›è¡Œèšåˆï¼Œ
æ“ä½œèµ·æ¥è¿˜æ˜¯å¾ˆæ–¹ä¾¿çš„ã€‚</p><p>kafkaçš„æ•°æ®å¦‚ä¸‹</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">{&quot;good_id&quot;:&quot;abc&quot;,&quot;price&quot;:300,&quot;user_id&quot;:123456,&quot;time&quot;:1553216320}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>é‚£æˆ‘ä»¬è¯¥æ€ä¹ˆåˆ©ç”¨ Seatunnel æ¥å®Œæˆè¿™ä¸ªéœ€æ±‚å‘¢ï¼Œå½“ç„¶è¿˜æ˜¯åªéœ€è¦é…ç½®å°±å¥½äº†ã€‚</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">#sparké‡Œçš„é…ç½®æ ¹æ®ä¸šåŠ¡éœ€æ±‚é…ç½®</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">spark {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.app.name = &quot;seatunnel&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.executor.instances = 2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.executor.cores = 1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.executor.memory = &quot;1g&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#é…ç½®input</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">input {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    kafkaStream {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        topics = &quot;good_topic&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        consumer.bootstrap.servers = &quot;localhost:9092&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        schema = &quot;{\&quot;good_id\&quot;:\&quot;string\&quot;,\&quot;price\&quot;:\&quot;integer\&quot;,\&quot;user_id\&quot;:\&quot;Long\&quot;,\&quot;time\&quot;:\&quot;Long\&quot;}&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#é…ç½®filter    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">filter {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    #åœ¨ç¨‹åºåšèšåˆçš„æ—¶å€™ï¼Œå†…éƒ¨ä¼šå»å­˜å‚¨ç¨‹åºä»å¯åŠ¨å¼€å§‹çš„èšåˆçŠ¶æ€ï¼Œä¹…è€Œä¹…ä¹‹ä¼šå¯¼è‡´OOM,å¦‚æœè®¾ç½®äº†watermarkï¼Œç¨‹åºè‡ªåŠ¨çš„ä¼šå»æ¸…ç†watermarkä¹‹å¤–çš„çŠ¶æ€</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    #è¿™é‡Œè¡¨ç¤ºä½¿ç”¨tså­—æ®µè®¾ç½®watermarkï¼Œç•Œé™ä¸º1å¤©</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Watermark {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        time_field = &quot;time&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        time_type = &quot;UNIX&quot;              #UNIXè¡¨ç¤ºæ—¶é—´å­—æ®µä¸º10ä¸ºçš„æ—¶é—´æˆ³ï¼Œè¿˜æœ‰å…¶ä»–çš„ç±»å‹è¯¦ç»†å¯ä»¥æŸ¥çœ‹æ’ä»¶æ–‡æ¡£</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        time_pattern = &quot;yyyy-MM-dd&quot;     #è¿™é‡Œä¹‹æ‰€ä»¥è¦æŠŠtså¯¹å…¶åˆ°å¤©æ˜¯å› ä¸ºæ±‚æ¯å¤©çš„é”€å”®é¢ï¼Œå¦‚æœæ˜¯æ±‚æ¯å°æ—¶çš„é”€å”®é¢å¯ä»¥å¯¹å…¶åˆ°å°æ—¶`yyyy-MM-dd HH`</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        delay_threshold = &quot;1 day&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        watermark_field = &quot;ts&quot;          #è®¾ç½®watermarkä¹‹åä¼šæ–°å¢ä¸€ä¸ªå­—æ®µï¼Œ`ts`å°±æ˜¯è¿™ä¸ªå­—æ®µçš„åå­—</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    #ä¹‹æ‰€ä»¥è¦group by tsæ˜¯è¦è®©watermarkç”Ÿæ•ˆï¼Œapprox_count_distinctæ˜¯ä¸€ä¸ªä¼°å€¼ï¼Œå¹¶ä¸æ˜¯ç²¾ç¡®çš„count_distinct</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    sql {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        table_name = &quot;good_table_2&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        sql = &quot;select good_id,sum(price) total, approx_count_distinct(user_id) person from good_table_2 group by ts,good_id&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#æ¥ä¸‹æ¥æˆ‘ä»¬é€‰æ‹©å°†ç»“æœå®æ—¶è¾“å‡ºåˆ°Kafka</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">output{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    kafka {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        topic = &quot;seatunnel&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        producer.bootstrap.servers = &quot;localhost:9092&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        streaming_output_mode = &quot;update&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        checkpointLocation = &quot;/your/path&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>å¦‚ä¸Šé…ç½®å®Œæˆï¼Œå¯åŠ¨ Seatunnelï¼Œå°±å¯ä»¥è·å–ä½ æƒ³è¦çš„ç»“æœäº†ã€‚</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="åœºæ™¯äºŒå¤šä¸ªæµå…³è”åœºæ™¯">åœºæ™¯äºŒï¼šå¤šä¸ªæµå…³è”åœºæ™¯<a class="hash-link" href="#åœºæ™¯äºŒå¤šä¸ªæµå…³è”åœºæ™¯" title="Direct link to heading">â€‹</a></h4><p>å‡è®¾ä½ åœ¨æŸä¸ªå¹³å°æŠ•æ”¾äº†å¹¿å‘Šï¼Œç°åœ¨è¦å®æ—¶è®¡ç®—å‡ºæ¯ä¸ªå¹¿å‘Šçš„CTR(ç‚¹å‡»ç‡)ï¼Œæ•°æ®åˆ†åˆ«æ¥è‡ªä¸¤ä¸ªtopicï¼Œä¸€ä¸ªæ˜¯å¹¿å‘Šæ›å…‰æ—¥å¿—ï¼Œä¸€ä¸ªæ˜¯å¹¿å‘Šç‚¹å‡»æ—¥å¿—,
æ­¤æ—¶æˆ‘ä»¬å°±éœ€è¦æŠŠä¸¤ä¸ªæµæ•°æ®å…³è”åˆ°ä¸€èµ·åšè®¡ç®—ï¼Œè€Œ Seatunnel æœ€è¿‘ä¹Ÿæ”¯æŒäº†æ­¤åŠŸèƒ½ï¼Œè®©æˆ‘ä»¬ä¸€èµ·çœ‹ä¸€ä¸‹è¯¥æ€ä¹ˆåšï¼š</p><p>ç‚¹å‡»topicæ•°æ®æ ¼å¼</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">{&quot;ad_id&quot;:&quot;abc&quot;,&quot;click_time&quot;:1553216320,&quot;user_id&quot;:12345}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>æ›å…‰topicæ•°æ®æ ¼å¼</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">{&quot;ad_id&quot;:&quot;abc&quot;,&quot;show_time&quot;:1553216220,&quot;user_id&quot;:12345}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain">#sparké‡Œçš„é…ç½®æ ¹æ®ä¸šåŠ¡éœ€æ±‚é…ç½®</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">spark {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.app.name = &quot;seatunnel&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.executor.instances = 2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.executor.cores = 1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark.executor.memory = &quot;1g&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#é…ç½®input</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">input {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    kafkaStream {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        topics = &quot;click_topic&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        consumer.bootstrap.servers = &quot;localhost:9092&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        schema = &quot;{\&quot;ad_id\&quot;:\&quot;string\&quot;,\&quot;user_id\&quot;:\&quot;Long\&quot;,\&quot;click_time\&quot;:\&quot;Long\&quot;}&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        table_name = &quot;click_table&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    kafkaStream {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        topics = &quot;show_topic&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        consumer.bootstrap.servers = &quot;localhost:9092&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        schema = &quot;{\&quot;ad_id\&quot;:\&quot;string\&quot;,\&quot;user_id\&quot;:\&quot;Long\&quot;,\&quot;show_time\&quot;:\&quot;Long\&quot;}&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        table_name = &quot;show_table&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">filter {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    #å·¦å…³è”å³è¡¨å¿…é¡»è®¾ç½®watermark</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    #å³å…³å·¦å³è¡¨å¿…é¡»è®¾ç½®watermark</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    #http://spark.apache.org/docs/latest/structured-streaming-programming-guide.html#inner-joins-with-optional-watermarking</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Watermark {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              source_table_name = &quot;click_table&quot; #è¿™é‡Œå¯ä»¥æŒ‡å®šä¸ºæŸä¸ªä¸´æ—¶è¡¨æ·»åŠ watermarkï¼Œä¸æŒ‡å®šçš„è¯å°±æ˜¯ä¸ºinputä¸­çš„ç¬¬ä¸€ä¸ª</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              time_field = &quot;time&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              time_type = &quot;UNIX&quot;               </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              delay_threshold = &quot;3 hours&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              watermark_field = &quot;ts&quot; </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              result_table_name = &quot;click_table_watermark&quot; #æ·»åŠ å®Œwatermarkä¹‹åå¯ä»¥æ³¨å†Œæˆä¸´æ—¶è¡¨ï¼Œæ–¹ä¾¿åç»­åœ¨sqlä¸­ä½¿ç”¨</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Watermark {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                source_table_name = &quot;show_table&quot; </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                time_field = &quot;time&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                time_type = &quot;UNIX&quot;               </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                delay_threshold = &quot;2 hours&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                watermark_field = &quot;ts&quot; </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                result_table_name = &quot;show_table_watermark&quot; </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    sql {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        table_name = &quot;show_table_watermark&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        sql = &quot;select a.ad_id,count(b.user_id)/count(a.user_id) ctr from show_table_watermark as a left join click_table_watermark as b on a.ad_id = b.ad_id and a.user_id = b.user_id &quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#æ¥ä¸‹æ¥æˆ‘ä»¬é€‰æ‹©å°†ç»“æœå®æ—¶è¾“å‡ºåˆ°Kafka</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">output {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    kafka {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        topic = &quot;seatunnel&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        producer.bootstrap.servers = &quot;localhost:9092&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        streaming_output_mode = &quot;append&quot; #æµå…³è”åªæ”¯æŒappendæ¨¡å¼</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        checkpointLocation = &quot;/your/path&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>é€šè¿‡é…ç½®ï¼Œåˆ°è¿™é‡Œæµå…³è”çš„æ¡ˆä¾‹ä¹Ÿå®Œæˆäº†ã€‚</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="ç»“è¯­">ç»“è¯­<a class="hash-link" href="#ç»“è¯­" title="Direct link to heading">â€‹</a></h3><p>é€šè¿‡é…ç½®èƒ½å¾ˆå¿«çš„åˆ©ç”¨StructuredStreamingåšå®æ—¶æ•°æ®å¤„ç†ï¼Œä½†æ˜¯è¿˜æ˜¯éœ€è¦å¯¹StructuredStreamingçš„ä¸€äº›æ¦‚å¿µäº†è§£ï¼Œæ¯”å¦‚å…¶ä¸­çš„watermarkæœºåˆ¶ï¼Œè¿˜æœ‰ç¨‹åºçš„è¾“å‡ºæ¨¡å¼ã€‚</p><p>æœ€åï¼ŒSeatunnel å½“ç„¶è¿˜æ”¯æŒspark streamingå’Œspark æ‰¹å¤„ç†ã€‚
å¦‚æœä½ å¯¹è¿™ä¸¤ä¸ªä¹Ÿæ„Ÿå…´è¶£çš„è¯ï¼Œå¯ä»¥é˜…è¯»æˆ‘ä»¬ä»¥å‰å‘å¸ƒçš„æ–‡ç« ã€Š<a href="/zh-CN/blog/page/i18n/zh-CN/docusaurus-plugin-content-blog/current/2021-12-30-hive-to-clickhouse.mdtent-blog/current/2021-12-30-hive-to-clickhouse.md">å¦‚ä½•å¿«é€Ÿåœ°å°†Hiveä¸­çš„æ•°æ®å¯¼å…¥ClickHouse</a>ã€‹ã€
ã€Š<a href="/zh-CN/blog/page/i18n/zh-CN/docusaurus-plugin-content-blog/current/2021-12-30-spark-execute-tidb.mdtent-blog/current/2021-12-30-spark-execute-tidb.md">ä¼˜ç§€çš„æ•°æ®å·¥ç¨‹å¸ˆï¼Œæ€ä¹ˆç”¨Sparkåœ¨TiDBä¸ŠåšOLAPåˆ†æ</a>ã€‹ã€
ã€Š<a href="/zh-CN/blog/page/i18n/zh-CN/docusaurus-plugin-content-blog/2021-12-30-spark-execute-elasticsearch.md/current/2021-12-30-spark-execute-elasticsearch.md">å¦‚ä½•ä½¿ç”¨Sparkå¿«é€Ÿå°†æ•°æ®å†™å…¥Elasticsearch</a>ã€‹</p><p>å¸Œæœ›äº†è§£ Seatunnel å’Œ HBase, ClickHouseã€Elasticsearchã€Kafkaã€MySQL ç­‰æ•°æ®æºç»“åˆä½¿ç”¨çš„æ›´å¤šåŠŸèƒ½å’Œæ¡ˆä¾‹ï¼Œå¯ä»¥ç›´æ¥è¿›å…¥å®˜ç½‘ <a href="https://seatunnel.apache.org/" target="_blank" rel="noopener noreferrer">https://seatunnel.apache.org/</a></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="è”ç³»æˆ‘ä»¬">è”ç³»æˆ‘ä»¬<a class="hash-link" href="#è”ç³»æˆ‘ä»¬" title="Direct link to heading">â€‹</a></h2><ul><li>é‚®ä»¶åˆ—è¡¨ : <strong><a href="mailto:dev@seatunnel.apache.org" target="_blank" rel="noopener noreferrer">dev@seatunnel.apache.org</a></strong>. å‘é€ä»»æ„å†…å®¹è‡³ <code>dev-subscribe@seatunnel.apache.org</code>ï¼Œ æŒ‰ç…§å›å¤è®¢é˜…é‚®ä»¶åˆ—è¡¨ã€‚</li><li>Slack: å‘é€ <code>Request to join SeaTunnel slack</code> é‚®ä»¶åˆ°é‚®ä»¶åˆ—è¡¨ (<code>dev@seatunnel.apache.org</code>), æˆ‘ä»¬ä¼šé‚€è¯·ä½ åŠ å…¥ï¼ˆåœ¨æ­¤ä¹‹å‰è¯·ç¡®è®¤å·²ç»æ³¨å†ŒSlackï¼‰.</li><li><a href="https://space.bilibili.com/1542095008" target="_blank" rel="noopener noreferrer">bilibili Bç«™ è§†é¢‘</a></li></ul></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/zh-CN/blog/tags/spark">Spark</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/zh-CN/blog/tags/structured-streaming">StructuredStreaming</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/zh-CN/blog"><div class="pagination-nav__label">Newer Entries</div></a></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">SeaTunnel</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/zh-CN/docs/faq">FAQ</a></li><li class="footer__item"><a href="https://github.com/apache/incubator-seatunnel/releases" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>ç‰ˆæœ¬<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">ç¤¾åŒº</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/apache/incubator-seatunnel" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/apache/incubator-seatunnel/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Issue Tracker<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/apache/incubator-seatunnel/pulls" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Pull Requests<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">è®¢é˜…é‚®ä»¶ç»„</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/zh-CN/community/contribution_guide/subscribe">How to Subscribe</a></li><li class="footer__item"><a href="mailto:dev-subscribe@seatunnel.apache.org" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>è®¢é˜…é‚®ä»¶<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://lists.apache.org/list.html?dev@seatunnel.apache.org" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>é‚®ä»¶å½’æ¡£<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"><div style="margin-top: 20px;background: #f4f8fa">
                <img style="height:50px;margin-bottom: 10px" alt="Apache Software Foundation" src="/zh-CN/image/incubator-logo.svg">
                <p style="color: #999999;font-weight:400;text-align:left">Apache SeaTunnel is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Apache Incubator. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.</p>
                <div style="border-top: 1px solid #ccc;min-height: 60px;line-height: 20px;text-align: center;font-family: Avenir-Medium;font-size: 14px;color: #999;display: flex;align-items: center;"><span>Copyright Â© 2021-2022 The Apache Software Foundation. Apache SeaTunnel, SeaTunnel, and its feather logo are trademarks of The Apache Software Foundation.</span></div>
                <div style="text-align: center;">
                    <a href="https://twitter.com/asfseatunnel?s=21" target="_blank" title="Twitter"><svg t="1644553365083" class="icon" viewBox="0 0 1260 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7015" width="25" height="25"><path d="M1259.846921 121.148242c-46.524504 20.728739-96.273478 34.547899-148.325646 40.536201 53.434084-31.784067 94.430924-82.454319 113.777747-142.797982-50.209613 29.480874-105.486251 51.13089-164.447999 62.646857A257.584528 257.584528 0 0 0 872.449815 0.000276c-142.797982 0-258.418284 115.620302-258.418284 258.418284 0 20.268101 2.303193 40.075563 6.909579 58.961748C405.82286 306.32498 215.579097 203.602561 87.98219 47.446058c-22.110655 38.233008-35.008538 82.454319-35.008538 129.900099 0 89.824537 45.603227 168.593747 115.159663 215.118251-42.378756-1.381916-81.99368-12.897882-117.002217-32.244706v3.224471c0 125.293713 88.90326 229.398049 207.287393 253.351259-21.650017 5.988302-44.681949 9.212773-68.17452 9.212773-16.582991 0-32.705344-1.842555-48.827697-4.606387 32.705344 102.722419 128.518184 177.345881 241.374653 179.649074-88.442621 69.095798-199.917175 110.553277-321.06514 110.553277-20.728739 0-41.457479-1.381916-61.72558-3.685109 114.238386 73.241546 250.126788 116.08094 396.149241 116.08094 475.379089 0 735.179289-393.846048 735.179289-735.179289 0-11.055328-0.460639-22.571294-0.921277-33.626621 51.13089-36.851092 94.891562-82.454319 129.439461-134.045848z" fill="#909094" p-id="7016"></path></svg></a> 
                    <a href="https://apacheseatunnel.slack.com" target="_blank" title="Slack" style="margin-left: 20px;"><svg t="1644553076784" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3088" width="23" height="23"><path d="M215.125333 647.04a107.861333 107.861333 0 0 1-107.52 107.648A107.861333 107.861333 0 0 1 0 647.04a107.818667 107.818667 0 0 1 107.605333-107.52h107.52v107.52z m54.229334 0a107.818667 107.818667 0 0 1 107.562666-107.52 107.818667 107.818667 0 0 1 107.562667 107.52v269.354667A107.861333 107.861333 0 0 1 376.917333 1024a107.861333 107.861333 0 0 1-107.562666-107.605333v-269.354667zM376.917333 215.125333a107.861333 107.861333 0 0 1-107.562666-107.52A107.861333 107.861333 0 0 1 376.917333 0a107.861333 107.861333 0 0 1 107.562667 107.605333v107.52H376.917333z m0 54.229334a107.861333 107.861333 0 0 1 107.562667 107.562666 107.861333 107.861333 0 0 1-107.562667 107.562667H107.605333A107.861333 107.861333 0 0 1 0 376.917333a107.861333 107.861333 0 0 1 107.605333-107.562666h269.312z m431.872 107.562666a107.861333 107.861333 0 0 1 107.605334-107.562666A107.861333 107.861333 0 0 1 1024 376.917333a107.861333 107.861333 0 0 1-107.605333 107.562667h-107.605334V376.917333z m-54.101333 0a107.861333 107.861333 0 0 1-107.648 107.562667 107.818667 107.818667 0 0 1-107.52-107.562667V107.605333A107.818667 107.818667 0 0 1 647.04 0a107.861333 107.861333 0 0 1 107.648 107.605333v269.312z m-107.648 431.872a107.861333 107.861333 0 0 1 107.648 107.605334A107.861333 107.861333 0 0 1 647.04 1024a107.818667 107.818667 0 0 1-107.52-107.605333v-107.605334h107.52z m0-54.101333a107.818667 107.818667 0 0 1-107.52-107.648 107.776 107.776 0 0 1 107.52-107.52h269.354667A107.818667 107.818667 0 0 1 1024 647.04a107.861333 107.861333 0 0 1-107.605333 107.648h-269.354667z" p-id="3089" fill="#909094"></path></svg></a> 
                    <a href="https://lists.apache.org/list.html?dev@seatunnel.apache.org" target="_blank" title="Mailing list" style="margin-left: 20px;"><svg t="1644553175467" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5304" width="26" height="26"><path d="M853.333333 170.666667H170.666667c-46.933333 0-85.333333 38.4-85.333334 85.333333v512c0 46.933333 38.4 85.333333 85.333334 85.333333h682.666666c46.933333 0 85.333333-38.4 85.333334-85.333333V256c0-46.933333-38.4-85.333333-85.333334-85.333333z m0 170.666666l-341.333333 213.333334-341.333333-213.333334V256l341.333333 213.333333 341.333333-213.333333v85.333333z" p-id="5305" fill="#909094"></path></svg></a> 
                    <a href="https://github.com/apache/incubator-seatunnel" target="_blank" title="GitHub" style="margin-left: 20px;"><svg t="1644553223000" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6156" width="23" height="23"><path d="M512 12.64c-282.752 0-512 229.216-512 512 0 226.208 146.72 418.144 350.144 485.824 25.6 4.736 35.008-11.104 35.008-24.64 0-12.192-0.48-52.544-0.704-95.328-142.464 30.976-172.512-60.416-172.512-60.416-23.296-59.168-56.832-74.912-56.832-74.912-46.464-31.776 3.52-31.136 3.52-31.136 51.392 3.616 78.464 52.768 78.464 52.768 45.664 78.272 119.776 55.648 148.992 42.56 4.576-33.088 17.856-55.68 32.512-68.48-113.728-12.928-233.28-56.864-233.28-253.024 0-55.904 20-101.568 52.768-137.44-5.312-12.896-22.848-64.96 4.96-135.488 0 0 43.008-13.76 140.832 52.48a491.296 491.296 0 0 1 128.16-17.248c43.488 0.192 87.328 5.888 128.256 17.248 97.728-66.24 140.64-52.48 140.64-52.48 27.872 70.528 10.336 122.592 5.024 135.488 32.832 35.84 52.704 81.536 52.704 137.44 0 196.64-119.776 239.936-233.792 252.64 18.368 15.904 34.72 47.04 34.72 94.816 0 68.512-0.608 123.648-0.608 140.512 0 13.632 9.216 29.6 35.168 24.576C877.472 942.624 1024 750.784 1024 524.64c0-282.784-229.248-512-512-512z" p-id="6157" fill="#909094"></path></svg></a> 
                </div>
            <div></div></div></div></div></div></footer></div>
<script src="/zh-CN/assets/js/runtime~main.41b866cf.js"></script>
<script src="/zh-CN/assets/js/main.accb60dc.js"></script>
</body>
</html>